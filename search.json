[{"title":"æŠ“å–ç½‘æ˜“äº‘éŸ³ä¹æ¦œå•","url":"/2018/12/20/æŠ“å–ç½‘æ˜“äº‘éŸ³ä¹æ¦œå•/","content":"\n\n## æ‘˜è¦\næœ¬æ–‡åˆ†åˆ«åˆ©ç”¨`Selenium`è‡ªåŠ¨åŒ–æµ‹è¯•å·¥å…·ä¸`requests`åº“æŠ“å–ç½‘æ˜“äº‘éŸ³ä¹çš„æ¦œå•ï¼ŒåŒ…æ‹¬æ­Œæ›²åã€æ­Œæ›²æ—¶é•¿ä»¥åŠæ¼”å”±è€…ç­‰ä¿¡æ¯ã€‚`Selenium`ä»…ä»…æŠ“å–äº†é¦–ä¸ªæ¦œå•ï¼Œ`requests`æŠ“å–äº†æ‰€æœ‰æ¦œå•ã€‚æŠ“å–ä¹‹åå°†æ‰€æœ‰æ•°æ®å­˜å…¥`MySQL`æ•°æ®åº“ä¸­ã€‚\n\n## SeleniumæŠ“å–å•ä¸ªè¡¨å•\n`Selenium`æ˜¯ä¸€ç§è‡ªåŠ¨åŒ–æµ‹è¯•å·¥å…·ï¼Œå®ƒå¯ä»¥æ¨¡æ‹Ÿæµè§ˆå™¨çš„è¡Œä¸ºï¼Œæ‰€ä»¥ä¹Ÿå¯ä»¥ç”¨äºçˆ¬è™«ã€‚ä¸‹è½½å¯¹åº”çš„[é©±åŠ¨](https://sites.google.com/a/chromium.org/chromedriver/downloads)ä¹‹åï¼Œå¯ä»¥è°ƒç”¨å„ç§ä¸»æµæµè§ˆå™¨ã€‚ä¸€èˆ¬åœ¨çˆ¬è™«çš„è¿‡ç¨‹å› ä¸ºæ•ˆç‡é—®é¢˜å¹¶ä¸æ‰“å¼€æµè§ˆå™¨ï¼Œè€Œä½¿ç”¨æ— ç•Œé¢çš„æ¨¡å¼ã€‚\n\n### æ‰§è¡Œè¿‡ç¨‹\n#### 1ã€åˆå§‹åŒ–å˜é‡\nåˆå§‹åŒ–çš„è¿‡ç¨‹ä¸­åŒ…æ‹¬è¯·æ±‚çš„`url`ï¼Œè¯·æ±‚çš„æ•°ç›®ä»¥åŠæ•°æ®åº“çš„ä¸€äº›é…ç½®ã€‚`selenium`ä½¿ç”¨`Chrome`é©±åŠ¨ã€‚\n```Python\ndef __init__(self):\n  self.url = \"https://music.163.com\"\n  self.count = 0\n  self.host = \"127.0.0.1\"\n  self.user = \"root\"\n  self.password = \"******\"\n  self.db = \"spider\"\n  self.chrome_option = Options()\n  self.chrome_option.add_argument('--headless')\n  self.DRIVER = webdriver.Chrome(chrome_options=self.chrome_option)\n  # The format string is not really a normal Python format string.\n  # You must always use %s for all fields.\n  self.importSQL = \"\"\"INSERT INTO NetEaseCloudMusic(ID, musicName, time, singer)\n            VALUES (%s, %s, %s, %s)\"\"\"\n```\n#### 2ã€è¿æ¥MySQLæ•°æ®åº“ï¼Œå¹¶ä»é¦–é¡µè·³è½¬åˆ°æ¦œå•é¡µ\næ ¹æ®åˆå§‹åŒ–çš„æ•°æ®åº“é…ç½®ä¿¡æ¯ï¼Œè¿æ¥ä¸Šæ•°æ®åº“åˆ é™¤æ—§è¡¨ï¼Œåˆ›å»ºæ–°è¡¨\n```python\ndef connect_mysql(self):\n  self.db = pymysql.connect(host=self.host, user=self.user, passwd=self.password, db=self.db)\n  print(\"æˆåŠŸè¿æ¥Mysqlæ•°æ®åº“\")\n  self.cursor = self.db.cursor()\n  self.cursor.execute(\"DROP TABLE IF EXISTS NetEaseCloudMusic\")\n  # å¦‚æœä½¿ç”¨å•å¼•å·ï¼Œéœ€è¦\n  sql = '''CREATE TABLE NetEaseCloudMusic(\n          ID INT NOT NULL,\n          musicName LONGTEXT,\n          time LONGTEXT,\n          singer LONGTEXT\n          )'''\n  self.cursor.execute(sql)\n```\n\næ¦œå•ä¿¡æ¯çš„urlä¸º`https://music.163.com/#/discover/toplist`ï¼Œæ‰€ä»¥éœ€è¦ä»é¦–é¡µè·³è½¬ã€‚è·³è½¬ä¹‹åè§‚å¯Ÿåˆ°æ¦œå•ä¿¡æ¯å¹¶ä¸æ˜¯ç›´æ¥åŠ è½½åœ¨ç½‘é¡µä¸­ï¼Œè€Œæ˜¯åœ¨é¡µé¢çš„`iframe`æ ‡ç­¾ä¸­ï¼Œæ‰€ä»¥éœ€è¦è·³è½¬åˆ°å­`iframe`æ‹¿åˆ°æ•°æ®\n```python\ndef jump_targetpage(self):\n  # å…¶ä¸­ driver.get æ–¹æ³•ä¼šæ‰“å¼€è¯·æ±‚çš„URLï¼Œ\n  # WebDriver ä¼šç­‰å¾…é¡µé¢å®Œå…¨åŠ è½½å®Œæˆä¹‹åæ‰ä¼šè¿”å›ï¼Œ\n  # å³ç¨‹åºä¼šç­‰å¾…é¡µé¢çš„æ‰€æœ‰å†…å®¹åŠ è½½å®Œæˆï¼ŒJSæ¸²æŸ“å®Œæ¯•ä¹‹åæ‰ç»§ç»­å¾€ä¸‹æ‰§è¡Œã€‚\n  self.DRIVER.get(self.url)\n  self.DRIVER.find_element_by_xpath('//ul[@class=\"nav\"]/li[2]').click()\n  try:\n    self.firstChild_iframe = self.DRIVER.find_element_by_id(\"g_iframe\")\n  except Exception as e:\n    print(\"Get iframe Failed: \", e)\n  sleep(2)\n  self.DRIVER.switch_to.frame(self.firstChild_iframe)\n  table = self.DRIVER.find_element_by_tag_name('table')\n  self.songList = table.find_elements_by_xpath('tbody/tr')\n  return self.songList\n```\n\n#### 3ã€æå–æ•°æ®å¹¶ä¿å­˜åˆ°æ•°æ®åº“ä¸­\nä½¿ç”¨`xpath`æ¥æå–æ­Œæ›²åç§°ã€æ’­æ”¾æ—¶é•¿ã€æ¼”å”±è€…ç­‰ä¿¡æ¯ã€‚\n```Python\ndef start_search(self, song):    \n  songChildList = []\n  songChildList.append(song.find_element_by_xpath('td[2]//b').get_attribute('title'))\n  songChildList.append(song.find_element_by_xpath('td[3]//span[@class=\"u-dur \"]').text)\n  songChildList.append(song.find_element_by_xpath('td[last()]//span').get_attribute('title'))\n  return songChildList\n```\n\nä¿å­˜åˆ°æ•°æ®åº“ä¸­ï¼Œå¹¶è®°å½•æ¯æ¬¡å¯¼å…¥çš„æ¡æ•°\n```python\ndef import_data(self, data):\n  try:\n    self.cursor.execute(self.importSQL, (self.count+1, data[0], data[1], data[2]))\n    self.db.commit()\n    self.count += 1\n    print(\"æˆåŠŸå¯¼å…¥ç¬¬{count}æ¡æ•°æ®\".format(count=self.count))\n  except Exception as e:\n    print('å¯¼å…¥æ•°æ®å¤±è´¥ï¼š ', e)\n    self.db.rollback()\n```\n### å°ç»“\nè¿™é‡Œå¹¶ä¸ä»‹ç»`Selenium`çš„å…·ä½“ä½¿ç”¨æ–¹å¼ï¼Œä¾§é‡äºæŠ“å–çš„è¿‡ç¨‹æè¿°ä»¥åŠå¦‚ä½•å®ç°è¿™ä¸€è¿‡ç¨‹çš„ç®€å•ä»£ç ç¤ºä¾‹ã€‚å®Œæ•´ä»£ç ï¼š[SeleniumæŠ“å–å•ä¸ªè¡¨å•](https://github.com/Cloving/NetEase-Spider/blob/master/%E7%BD%91%E6%98%93%E4%BA%91%E9%9F%B3%E4%B9%90%E6%A6%9C%E5%8D%95/selenium_NetEaseMusic.py)\n\n## requestsæŠ“å–æ‰€æœ‰è¡¨å•\nåˆ†æç½‘æ˜“äº‘éŸ³ä¹æ¦œå•é¡µé¢çš„ç½‘ç»œè¯·æ±‚ï¼Œå¦‚å›¾æ‰€ç¤ºï¼š\n![é»˜è®¤é¡µé¢è¯·æ±‚](https://cdn.jsdelivr.net/gh/Cloving/Atlas-Github/blog/notePicture/æŠ“å–ç½‘æ˜“äº‘éŸ³ä¹æ¦œå•/é»˜è®¤é¡µé¢è¯·æ±‚.jpg)\n\nä»é»˜è®¤é¡µé¢`https://music.163.com/#/discover/toplist`è¯·æ±‚çš„å“åº”ä¿¡æ¯å¯ä»¥çœ‹åˆ°å„ç±»æ¦œå•çš„æ ‡é¢˜ä»¥åŠ`href`å±æ€§ä¿¡æ¯ã€‚äº‹å®ä¸Šï¼Œé€šè¿‡è§‚å¯Ÿæµè§ˆå™¨åœ°å€æ çš„`url`å¯ä»¥çœ‹å‡º`href`çš„å±æ€§å€¼ä½äº`#`ä¹‹åï¼Œæ‰€ä»¥è¿™æ˜¯ä¸€ä¸ª`fragment`ï¼Œè®¿é—®ç½‘ç«™ä¹‹åå¯ä»¥ç›´æ¥åˆ°è¾¾é¡µé¢çš„æŒ‡å®šä½ç½®ã€‚æˆ‘ä»¬éœ€è¦æå–å‡ºæ¯ä¸ªæ¦œå•çš„`href`å±æ€§ä¿¡æ¯ï¼Œå†é€ä¸ªè¯·æ±‚è¿™äº›`url`ï¼Œé€šè¿‡è¿”å›çš„å“åº”åˆ†æå‡ºæ¯ä¸ª`url`ä¸­åŒ…å«çš„æ­Œæ›²ä¿¡æ¯ï¼Œå†é€ä¸ªä¿å­˜åˆ°æ•°æ®åº“ä¸­ï¼Œå¹¶ç»Ÿè®¡æ€»çš„æ•°æ®é‡ã€‚\n\n### è¯·æ±‚è¿‡ç¨‹\nåˆå§‹åŒ–å˜é‡ä»¥åŠè¿æ¥æ•°æ®åº“çš„éƒ¨åˆ†åœ¨ä½¿ç”¨`selenium`è¯·æ±‚ä¸­å·²ç»ä»‹ç»è¿‡ï¼Œå¤§åŒå°å¼‚ã€‚æ­¤å¤„ä¸å†è¿‡å¤šä»‹ç»ï¼Œåœ¨æ–‡ç« ç»“å°¾å¤„ä¼šç»™å‡ºæºä»£ç çš„é“¾æ¥ã€‚\nå…³äºå‘èµ·è¯·æ±‚çš„å‡½æ•°éƒ¨åˆ†ï¼Œç”±äºè¯·æ±‚çš„`url`åŒ…æ‹¬åˆå§‹çš„`url`ä»¥åŠæ¯ä¸ªæ¦œå•çš„`url`ï¼Œæ‰€ä»¥åœ¨è¯·æ±‚å‡½æ•°ä¸­è€ƒè™‘ä½¿ç”¨å¯å˜æ•°é‡çš„å‚æ•°ï¼Œå¦‚æœæ²¡æœ‰ä¼ å…¥å…¶ä»–å‚æ•°åˆ™ä½¿ç”¨åˆå§‹åŒ–çš„`url`ï¼Œå¦åˆ™ä½¿ç”¨ä¼ å…¥çš„`url`ã€‚è¿‡ç¨‹å¦‚ä¸‹ï¼š\n\n``` python\ndef start_request(self, *arg):\n  # å‘ç»™å®šçš„urlè¯·æ±‚æ•°æ®ï¼Œå¦‚æœargä¸ºç©ºï¼Œè¯·æ±‚åŸå§‹çš„urlï¼Œå¦åˆ™è¯·æ±‚arg\n  url = arg if arg else self.url\n  if isinstance(url, tuple):\n    # argæ˜¯å…ƒç»„ç±»å‹\n    request_url = url[0]\n  else:\n    request_url = url\n  try:\n    response = requests.get(request_url, headers=self.header)\n    if response.status_code == 200:\n      print(\"è¯·æ±‚æˆåŠŸ\")\n    return response\n  except Exception as e:\n    print(\"è¯·æ±‚å¤±è´¥ï¼Œå¤±è´¥åŸå› ï¼š\", e)\n```\n\n### å¤„ç†åŸå§‹è¯·æ±‚çš„æ•°æ®\nå¯¹åŸå§‹çš„`url`å‘é€è¯·æ±‚æ—¶ï¼Œä½¿ç”¨`æ­£åˆ™è¡¨è¾¾å¼`æå–æ‰€æœ‰æ¦œå•çš„`href`å±æ€§ï¼Œå†ä¸åŸå§‹çš„`url`è¿›è¡Œæ‹¼æ¥ï¼ˆå› ä¸ºæ‹¼æ¥çš„`url`å³ä½¿ä¸å¸¦æœ‰`#`ä¹Ÿä¼šè‡ªåŠ¨è·³è½¬ï¼Œæ‰€ä»¥ä»£ç ä¸­å¹¶æœªæ·»åŠ `#`ï¼‰ï¼Œå¾—åˆ°å¹¶è¯·æ±‚å•ä¸ªæ¦œå•çš„`url`ã€‚\nå•ä¸ªæ¦œå•çš„`url`ä¸­å¹¶ä¸èƒ½å¤Ÿæ‰¾åˆ°è§„åˆ™çš„æ­Œæ›²æ•°æ®ã€‚é€šè¿‡è§‚å¯Ÿå‘ç°æ‰€æœ‰æ­Œæ›²æ•°æ®éƒ½å­˜åœ¨å…¶ä¸­ä¸€ä¸ª`textarea`çš„æ ‡ç­¾ä¸­ï¼Œæ ‡ç­¾ä¸­çš„æ•°æ®ä¸º`json`æ ¼å¼ï¼Œæ‰€ä»¥éœ€è¦åˆ©ç”¨è¿™äº›`json`æ•°æ®æå–æ­Œæ›²ä¿¡æ¯ã€‚è¿™é‡Œé€šè¿‡`æ­£åˆ™è¡¨è¾¾å¼`å°†å…¶æå–å‡ºæ¥ã€‚\n\n\n![å•ä¸ªæ¦œå•è¯·æ±‚](https://cdn.jsdelivr.net/gh/Cloving/Atlas-Github/blog/notePicture/æŠ“å–ç½‘æ˜“äº‘éŸ³ä¹æ¦œå•/å•ä¸ªæ¦œå•è¯·æ±‚.png)\n\n``` python\ndef process_data(self, source_response):\n  # å¤„ç†åŸå§‹urlçš„è¯·æ±‚ï¼Œæå–å¹¶å¤„ç†æ¯ä¸ªæ¦œå•çš„url\n  pattern = re.compile('<p class=\"name\"><a href=\"(.*?)\" class=\"s-fc0\">')\n  lists_link = pattern.findall(source_response.text)\n  for list_link in lists_link:\n    url = parse.urljoin(self.url, list_link)\n    list_response = self.start_request(url)\n    json_datas = self.process_jsondata(list_response)\n    self.process_musicdata(json_datas)\n\ndef process_jsondata(self, response):\n  # æå–æ¯ä¸ªæ¦œå•çš„jsonæ•°æ® \n  pattern = re.compile('.*?id=\"song-list-pre-data\".*?>(.*?)</textarea>')\n  match = pattern.search(response.text)\n  json_datas = json.loads(match.group(1))\n  with open('data.json', 'wb') as f:\n    f.write(match.group(1).encode('utf8'))\n  return json_datas\n```\n\n### å¤„ç†åŒ…å«æ­Œæ›²ä¿¡æ¯çš„jsonæ•°æ®\næ­Œæ›²åä¸æ¼”å”±è€…éƒ½å¯ä»¥ç›´æ¥ä»`json`ä¸­ç›´æ¥æ–¹ä¾¿çš„è¯»å–åˆ°ï¼Œä½†æ˜¯æ­Œæ›²çš„æ—¶é•¿å¹¶ä¸èƒ½ä»æ•°æ®ä¸­ç›´æ¥çœ‹å‡ºæ¥ã€‚æ‰€ä»¥å›åˆ°åŸå§‹æ¦œå•çš„å“åº”ä¸­å¯»æ‰¾ä¿¡æ¯ï¼Œå‘ç°äº†å¯èƒ½æ˜¯æ§åˆ¶æ­Œæ›²æ—¶é•¿æ˜¾ç¤ºçš„éƒ¨åˆ†ï¼Œå¦‚å›¾æ‰€ç¤ºï¼š\n\n![æ­Œæ›²æ—¶é•¿](https://cdn.jsdelivr.net/gh/Cloving/Atlas-Github/blog/notePicture/æŠ“å–ç½‘æ˜“äº‘éŸ³ä¹æ¦œå•/æ­Œæ›²æ—¶é•¿.png)\n\nä»¥ä¸‹è¯­å¥ä¸ºæ§åˆ¶æ­Œæ›²æ—¶é•¿æ˜¾ç¤ºçš„ä»£ç ï¼š\n``` javascript\n${dur2time(x.duration/1000)}\n```\n\nå®é™…ä¸Šæˆ‘å¹¶æ²¡æœ‰åœ¨æ‰€æœ‰ç½‘ç»œè¯·æ±‚ä¸­æ‰¾åˆ°æœ‰å…³`dur2time`çš„ä¿¡æ¯ï¼ˆä¹Ÿå¯èƒ½æ˜¯æˆ‘è¿˜ä¸çŸ¥é“æ€æ ·åˆ†æè¿™ä¸€éƒ¨åˆ†ï¼‰ã€‚ä½†åœ¨`json`æ•°æ®ä¸­å­˜åœ¨`duration`çš„`key`ï¼Œæ‰€ä»¥æˆ‘è®¤ä¸º`duration`çš„æ•°å€¼å¯èƒ½ä¼šé€šè¿‡æŸç§è½¬æ¢ï¼Œæ˜¾ç¤ºä¸ºæ­Œæ›²æ—¶é•¿ã€‚å°†`duration`çš„å€¼é™¤ä»¥1000ä¸é¡µé¢ä¸­æ˜¾ç¤ºçš„æ­Œæ›²æ—¶é•¿å¯¹åº”èµ·æ¥ï¼Œè¯•ç€æ‰¾åˆ°å…¶ä¸­çš„è§„å¾‹ã€‚\n\n- 179.2 &nbsp;&nbsp;  02ï¼š59\n- 216 &nbsp;&nbsp;  03ï¼š36\n\nä»ä»¥ä¸Šçš„å¯¹åº”å…³ç³»ä¸­åŸºæœ¬ä¸Šå¯ä»¥åˆ¤æ–­`duration`é™¤ä»¥1000å³æ˜¯æ­Œæ›²æ—¶é•¿çš„ç§’æ•°ã€‚\nåˆ°æ­¤å¯ä»¥ä¾¿å¯ä»¥å¯¹æ­Œæ›²çš„æ•°æ®è¿›è¡Œæå–ã€‚è¿‡ç¨‹å¦‚ä¸‹æ‰€ç¤ºï¼š\n\n```python\ndef process_musicdata(self, json_datas):\n  # å¤„ç†æ¯ä¸ªæ¦œå•çš„jsonæ•°æ®\n  for json_data in json_datas:\n    music_name = json_data.get(\"name\")\n    play_time = self.process_playtime(json_data.get(\"duration\")/1000)\n    singers = ''\n    for artist in json_data.get(\"artists\"):\n      singers += '/' + artist.get(\"name\")\n    singers = singers.replace('/', '', 1)\n    data = [music_name, play_time, singers]\n    self.save_data(data)\n\ndef process_playtime(self, duration):\n  # å¤„ç†æ’­æ”¾æ—¶é—´æ•°æ®\n  minutes = math.floor(duration/60)\n  seconds = math.floor(duration%60)\n  minutes = minutes if minutes >= 10 else '0'+str(minutes)\n  seconds = seconds if seconds >= 10 else '0'+str(seconds)\n  return '%s:%s' % (minutes, seconds)\n```\n\n### ä¿å­˜åˆ°æ•°æ®åº“ä¸­\næ¯æ¬¡å¤„ç†ä¸€ä¸ªæ¦œå•çš„å“åº”ä¾¿ä¿å­˜åˆ°æ•°æ®åº“ä¸­ã€‚æœ¬æ¬¡æå–çš„æ‰€æœ‰æ­Œæ›²æ¦œå•ï¼Œå…±æœ‰`1614`æ¡éŸ³ä¹æ•°æ®\n```python\ndef save_data(self, data):\n  # ä¿å­˜æ•°æ®åˆ°æ•°æ®åº“\n  try:\n    self.cursor.execute(self.importSQL, (self.count, data[0],data[1],data[2]))\n    self.db.commit()\n    print(\"æˆåŠŸå¯¼å…¥ç¬¬{count}æ¡æ•°æ®\".format(count=self.count))\n    self.count += 1\n  except Exception as e:\n    print(\"å¯¼å…¥æ•°æ®å¤±è´¥ï¼Œå¤±è´¥åŸå› ï¼š\", e)\n    self.db.rollback()\n```\n\n## æ€»ç»“\næœ¬æ–‡åˆ†åˆ«ä½¿ç”¨äº†`Selenium`ä¸`requests`ä¸¤ç§æ–¹å¼æŠ“å–éŸ³ä¹æ¦œå•æ•°æ®ã€‚å®é™…æµ‹è¯•ä¸­`Selenium`çš„æŠ“å–é€Ÿåº¦è¾ƒæ…¢ï¼Œä½†æ˜¯è¿‡ç¨‹ç›¸å¯¹ç®€å•ã€‚ä½¿ç”¨`requests`è¯·æ±‚è¿‡ç¨‹ç¨æ˜¾å¤æ‚ï¼Œä½†æ˜¯é€Ÿåº¦è¾ƒå¿«ã€‚å®Œæ•´ä»£ç ï¼š[æŠ“å–ç½‘æ˜“äº‘éŸ³ä¹æ¦œå•](https://github.com/Cloving/NetEase-Spider/tree/master/%E7%BD%91%E6%98%93%E4%BA%91%E9%9F%B3%E4%B9%90%E6%A6%9C%E5%8D%95)\n\n\n## å‚è€ƒæ–‡çŒ®\n[1ã€Selenium with Python Selenium Python Bindings 2 documentation](https://selenium-python.readthedocs.io/)\n[2ã€Getting Started with Headless Chrome | Web | Google Developers](https://developers.google.com/web/updates/2017/04/headless-chrome)\n[3ã€2. å¿«é€Ÿå…¥é—¨ Selenium-Pythonä¸­æ–‡æ–‡æ¡£ 2 documentation](https://selenium-python-zh.readthedocs.io/en/latest/getting-started.html)\n[4ã€python3 urllib.parse.urljoinï¼ˆï¼‰ç”¨æ³• - ä½™å®‰ - CSDNåšå®¢](https://blog.csdn.net/mycms5/article/details/76902041)\n[5ã€20.7. urllib.parse â€” Parse URLs into components &mdash; Python v3.2.6 documentation](https://docs.python.org/3.2/library/urllib.parse.html)\n\n\n","tags":["Python","æ­£åˆ™è¡¨è¾¾å¼","MySQL","Selenium"],"categories":["æ•°æ®æŠ“å–","ç½‘æ˜“äº‘éŸ³ä¹"]},{"title":"æŠ“å–çŸ¥ä¹ç”¨æˆ·ç²‰ä¸æ•°æ®","url":"/2018/12/13/æŠ“å–çŸ¥ä¹ç”¨æˆ·ç²‰ä¸æ•°æ®/","content":"\n## æ‘˜è¦\næœ¬æ–‡æŠ“å–å¹¶åˆ†æäº†çŸ¥ä¹ç”¨æˆ·çš„ç²‰ä¸æ•°æ®ï¼ŒåŒ…æ‹¬ç²‰ä¸åã€ç²‰ä¸æ ‡é¢˜ã€ç²‰ä¸ç”·å¥³æ¯”ä¾‹ã€ç²‰ä¸å›ç­”é—®é¢˜æ¯”ä¾‹ã€ç²‰ä¸è¢«å…³æ³¨æ•°ç­‰æ•°æ®ã€‚ä¹‹ååˆ©ç”¨`pyecharts`åº“å¯¹è¿™äº›æ•°æ®è¿›è¡Œå¯è§†åŒ–æ˜¾ç¤ºã€‚\n<br/>\n## æŠ“å–æ•°æ®\n### 1ã€è¯·æ±‚çš„urlä¸ä»£ç†\nä¸ä¹‹å‰ä¸€ç¯‡æ–‡ç« [æŠ“å–çŸ¥ä¹ç”¨æˆ·åŠ¨æ€æ•°æ®](http://yaodongsheng.com/2018/11/20/æŠ“å–çŸ¥ä¹ç”¨æˆ·åŠ¨æ€æ•°æ®/)ç±»ä¼¼ï¼Œè¿™é‡Œè¯·æ±‚çš„urlä¹Ÿæ˜¯è¿”å›jsonæ•°æ®ï¼Œæ‰€ä»¥åŒæ ·åœ¨æ§åˆ¶å°networké€‰é¡¹ä¸‹æ‰¾åˆ°è¯·æ±‚çš„urlï¼Œé€šè¿‡è§‚å¯Ÿå¤šä¸ªè¯·æ±‚çš„urlå°†å…¶åˆ†ä¸ºé€šç”¨éƒ¨åˆ†ä¸æ‰©å±•éƒ¨åˆ†ï¼Œå¦‚ä¸‹å½¢å¼ï¼š\n```Python\nself.base_url = \"https://www.zhihu.com/api/v4/members/{user}/followers?{include}\"\nself.include = 'include=data%5B*%5D.answer_count%2Carticles_count%2C\\\n  gender%2Cfollower_count%2Cis_followed%2Cis_following%2C\\\n  badge%5B%3F(type%3Dbest_answerer)%5D.topics&offset={offset}&limit=20'\n```\nå…¶ä¸­`user`ä¸ºç”¨æˆ·çš„ä¸ªæ€§åŒ–åŸŸåï¼Œ`include`ä¸ºæ‰©å±•éƒ¨åˆ†çš„urlï¼Œ`offset`ä¸ºåç§»é‡ï¼Œå³ä»ç¬¬`offset`æ¡æ•°æ®å¼€å§‹ã€‚\nä»£ç†ä½¿ç”¨[fake-useragent](https://pypi.org/project/fake-useragent/)åº“ï¼Œæ¯æ¬¡è¯·æ±‚éƒ½éšæœºç”Ÿæˆï¼Œä¿è¯æ¯æ¬¡è¯·æ±‚çš„`header`éƒ½ä¸ä¸€æ ·ã€‚\n<br/>\n### 2ã€è®¾ç½®å¾ªç¯æŠ“å–\né¦–å…ˆæ ¹æ®urlè¯·æ±‚`json`æ•°æ®ï¼Œä¹‹åå¤„ç†è¯·æ±‚åˆ°çš„æ•°æ®ï¼Œå¾—åˆ°ä¸€éƒ¨åˆ†ç²‰ä¸çš„ä¿¡æ¯ï¼Œå¦‚æœç²‰ä¸ä¿¡æ¯æ²¡æœ‰æŠ“å–å®Œï¼Œåˆ™å¯¹æŠ“å–çš„`url`è¿›è¡Œæ›´æ–°ï¼Œç›´åˆ°æ•°æ®æŠ“å–å®Œæˆï¼Œç»“æŸçš„æ ‡å¿—ä¼šåœ¨è¯·æ±‚çš„`json`æ•°æ®ä¸­è·å–åˆ°ã€‚æœ€åå¯¹æå–åˆ°çš„æ‰€æœ‰æ•°æ®è¿›è¡Œä¿å­˜ã€‚ä»£ç å¦‚ä¸‹ï¼š\n```Python\ndef start(self, username, savepath, savename):\n  index = 0\n  flag = True\n  while flag:\n    offset=index*20\n    include = self.include.format(offset=offset)\n    url = self.base_url.format(user=username, include=include)\n    # è¯·æ±‚jsonæ•°æ®\n    print(\"æ­£åœ¨è¿›è¡Œç¬¬{}æ¬¡è¯·æ±‚\".format(index+1))\n    jsonData = self.requests_source(url)\n    # æå–éœ€è¦çš„æ•°æ®\n    self.process_data(jsonData)\n    # å¦‚æœä»ç„¶å­˜åœ¨æ•°æ®ï¼Œå¤„ç†ä¸‹ä¸€æ¬¡è¯·æ±‚\n    if jsonData.get('paging').get('is_end') is False:\n      index = index + 1\n      self.header['user-agent'] = self.agent.random\n    else:\n      flag = False\n      print(\"å®Œæˆè¯·æ±‚\")\n  # ä¿å­˜æ•°æ®\n  self.save_data(self.data, savepath, savename)\n```\n<br/>\n### 3ã€è¯·æ±‚ã€å¤„ç†æ•°æ®\nè¯·æ±‚å¤„ç†çš„è¿‡ç¨‹å¹¶ä¸å¤æ‚ï¼Œæ ¹æ®è¿”å›çš„çŠ¶æ€ç åˆ¤æ–­æ˜¯å¦æˆåŠŸæ‹¿åˆ°`json`ï¼Œä¹‹åä¼šæ ¹æ®`json`çš„å…·ä½“å½¢å¼è§£ææ•°æ®ã€‚\n```Python\ndef requests_source(self, url):\n  try:\n    response = requests.get(url, headers=self.header, timeout=(5,30))\n    if response.status_code == 200:\n      return response.json()\n  except requests.ConnectionError as e:\n    print(\"è·å–è¯·æ±‚å¤±è´¥ï¼Œå¤±è´¥åŸå› ï¼š\", e)\n\ndef process_data(self, jsonData):\n  followers = jsonData.get('data')\n  for follow in followers:\n    name = self.read_data_from_jsonData(follow, 'name')\n    headline = self.read_data_from_jsonData(follow, 'headline')\n    gender = self.read_data_from_jsonData(follow, 'gender')\n    follower_count = self.read_data_from_jsonData(follow, 'follower_count')\n    answer_count = self.read_data_from_jsonData(follow, 'answer_count')\n    self.data[name] = [headline, gender, follower_count, answer_count]\n    print(name, self.data[name])\n  print('\\n')\n\ndef read_data_from_jsonData(self, json, key):\n  value = json.get(key)\n  return value if value is not '' else 'Empty'\n```\n<br/>\n### 4ã€ä¿å­˜æ•°æ®\nè¿™é‡Œå°†æ‰€æœ‰ä¿¡æ¯ä¿å­˜åˆ°`pkl`æ–‡ä»¶å½“ä¸­\n```Python\ndef save_data(self, follower_data, savepath, savename):\n  if not os.path.exists(savepath):\n    os.mkdir(savepath)\n  with open(os.path.join(savepath, savename), 'wb') as f:\n    pickle.dump(follower_data, f)\n  f.close()\n  print(\"å®Œæˆå­˜å‚¨\")\n```\nå®Œæˆæ‰€æœ‰ä¿¡æ¯çš„æŠ“å–ã€å¤„ç†åŠä¿å­˜ä¹‹åä¸‹ä¸€æ­¥å°±æ˜¯è§£æå¯è§†åŒ–è¿™äº›æ•°æ®ã€‚\n<br/>\n## å¯è§†åŒ–æ•°æ®\nå¯è§†åŒ–æ•°æ®åˆ©ç”¨äº†[pyecharts](http://pyecharts.org/)åº“ä¸[jieba](https://pypi.org/project/jieba/)åº“ï¼Œå‰è€…ç”¨äºå¯è§†åŒ–å„ç±»å›¾è¡¨ï¼Œåè€…æ˜¯Pythonçš„ä¸­æ–‡åˆ†è¯ç»„ä»¶ã€‚\n<br/>\n### 1ã€æ‰“å¼€`pkl`æ–‡ä»¶\nä¿å­˜`pkl`æ–‡ä»¶çš„åç§°å¯ä»¥è‡ªè¡ŒæŒ‡å®šï¼Œæ¯æ¬¡æŠ“å–å¦‚æœæ–‡ä»¶åç§°æ”¹å˜é‚£ä¹ˆåˆ†ææ•°æ®çš„æ—¶å€™éœ€è¦ä¿®æ”¹ä»£ç ï¼Œæ‰€ä»¥ä½¿ç”¨äº†æ­£åˆ™åŒ¹é…ï¼Œè¿™æ ·æ— éœ€å…³å¿ƒpklæ–‡ä»¶çš„åç§°å°±å¯ä»¥ç›´æ¥è¿è¡Œã€‚ä»£ç å¦‚ä¸‹ï¼š\n```Python\nfor root, dirs, files in os.walk(os.path.join(os.path.dirname(__file__),'result')):\n  # print(root)  # å½“å‰ç›®å½•è·¯å¾„\n  # print(dirs)  # å½“å‰è·¯å¾„ä¸‹æ‰€æœ‰å­ç›®å½•\n  # print(files)  # å½“å‰è·¯å¾„ä¸‹æ‰€æœ‰éç›®å½•å­æ–‡ä»¶\n  for file in files:\n    try:\n      file_name = re.search('(.*?).pkl', file).group()\n      break\n    except Exception as e:\n      continue\nwith open('./result/'+file_name, 'rb') as f:\n  followers_data = pickle.load(f)\n```\n<br/>\n### 2ã€æå–æ•°æ®\nä¸ºäº†ä¾¿äºåˆ†æã€å¯è§†åŒ–æ•°æ®ï¼Œæ‰€ä»¥ä¼šå°†æ‰€æœ‰æ•°æ®æå–æˆ`[(å…ƒç»„1), (å…ƒç»„2),...,(å…ƒç»„3)]`çš„å½¢å¼ï¼Œä¾‹å¦‚æ€§åˆ«æ•°æ®çš„å½¢å¼ä¸º\n```Python\n[('ç”·æ€§': 32),('å¥³æ€§': 42),('ä¿å¯†': 52)]\n```\n\nç”Ÿæˆ`headline`ä¸`ç”¨æˆ·å`çš„è¯äº‘å›¾æ—¶ä½¿ç”¨`jieba`åº“åˆ†è¯ï¼Œå…¶ä¸­åœ¨å¤„ç†`headline`æ—¶éœ€è¦åˆ é™¤æ‰ä¸€äº›ç¬¦å·å­—ç¬¦ä¹‹åå†ç»Ÿè®¡è¯é¢‘\n```Python\ndef statistic_word_frequency(self, texts, stopwords):\n  # ç»Ÿè®¡è¯é¢‘\n  statistic_dict = {}\n  for text in texts:\n    temp = jieba.cut(text, cut_all=False)\n    for t in temp:\n      if t in stopwords or t == 'Empty':\n        continue;\n      if t in statistic_dict.keys():\n        statistic_dict[t] += 1\n      else:\n        statistic_dict[t] = 1\n  return list(statistic_dict.items())\n```\nstopwordsç”¨æ¥å­˜å‚¨éœ€è¦åˆ é™¤æ‰çš„ä¸€äº›å­—ç¬¦ã€‚\n<br/>\n\n### 3ã€ç¤ºä¾‹å›¾\nç¤ºä¾‹å›¾æ˜¯éšæœºå¯»æ‰¾çš„ä¸€ä½çŸ¥ä¹ç”¨æˆ·è¿›è¡Œåˆ†æçš„ç»“æœ\n![æ ‡é¢˜è¯äº‘å›¾](https://cdn.jsdelivr.net/gh/Cloving/Atlas-Github/blog/notePicture/æŠ“å–çŸ¥ä¹ç”¨æˆ·ç²‰ä¸æ•°æ®/æ ‡é¢˜è¯äº‘å›¾.png)\n![ç”¨æˆ·åè¯äº‘å›¾](https://cdn.jsdelivr.net/gh/Cloving/Atlas-Github/blog/notePicture/æŠ“å–çŸ¥ä¹ç”¨æˆ·ç²‰ä¸æ•°æ®/ç”¨æˆ·åè¯äº‘å›¾.png)\n![ç²‰ä¸è¢«å…³æ³¨æ•°é‡ç›´æ–¹å›¾](https://cdn.jsdelivr.net/gh/Cloving/Atlas-Github/blog/notePicture/æŠ“å–çŸ¥ä¹ç”¨æˆ·ç²‰ä¸æ•°æ®/ç²‰ä¸è¢«å…³æ³¨æ•°é‡ç›´æ–¹å›¾.png)\n![ç²‰ä¸å›ç­”æ•°é‡ç›´æ–¹å›¾](https://cdn.jsdelivr.net/gh/Cloving/Atlas-Github/blog/notePicture/æŠ“å–çŸ¥ä¹ç”¨æˆ·ç²‰ä¸æ•°æ®/ç²‰ä¸å›ç­”æ•°é‡ç›´æ–¹å›¾.png)\n![ç²‰ä¸ç”·å¥³æ¯”ä¾‹é¥¼å›¾](https://cdn.jsdelivr.net/gh/Cloving/Atlas-Github/blog/notePicture/æŠ“å–çŸ¥ä¹ç”¨æˆ·ç²‰ä¸æ•°æ®/ç²‰ä¸ç”·å¥³æ¯”ä¾‹é¥¼å›¾.png)\n\n<br/>\n## æ€»ç»“\næœ¬æ–‡çš„æ€è·¯å‚è€ƒäº†çŸ¥ä¹ç”¨æˆ·[Charles](https://www.zhihu.com/people/charles_pikachu/activities)çš„çˆ¬è™«é¡¹ç›®ã€‚æœ€ç»ˆå®Œæˆçš„ä»£ç ï¼š[çŸ¥ä¹ç”¨æˆ·ç²‰ä¸](https://github.com/Cloving/zhihu-Spider/tree/master/%E7%9F%A5%E4%B9%8E%E7%94%A8%E6%88%B7%E7%B2%89%E4%B8%9D)\n\n\n## å‚è€ƒæ–‡çŒ®\n1ã€[Charlesçš„çš®å¡ä¸˜](https://mp.weixin.qq.com/s/hWUvMFIAMBrgR2Is9P5QXw)\n2ã€[pyecharts - A Python Echarts Plotting Library](http://pyecharts.org/#/zh-cn/charts_base)\n3ã€[fxsjy/jieba: ç»“å·´ä¸­æ–‡åˆ†è¯](https://github.com/fxsjy/jieba)\n","tags":["Echarts","Python","æ­£åˆ™è¡¨è¾¾å¼","è¯äº‘"],"categories":["æ•°æ®æŠ“å–","çŸ¥ä¹"]},{"title":"Echartsè¶³è¿¹å›¾","url":"/2018/12/08/Echartsè¶³è¿¹å›¾/","content":"\n## æ‘˜è¦\n`Echarts`æ˜¯ç™¾åº¦EFEå¯è§†åŒ–å›¢é˜Ÿå¼€å‘çš„åŸºäº`Javascript`å¼€æºå¯è§†åŒ–å›¾è¡¨åº“ã€‚ç”±äºéƒ¨åˆ†blogæ–‡ç« ä¸­æœ‰å±•ç¤ºå›¾è¡¨çš„éœ€æ±‚ï¼ŒåŸºäºæ­¤ï¼Œæœ¬æ–‡ç ”ç©¶äº†å¦‚ä½•å°†`Echarts`çš„å›¾è¡¨åµŒå…¥åˆ°blogä¸­å»ã€‚\n<br/>\n## Hexoæ’ä»¶\n[hexo-tag-echarts3](https://github.com/kchen0x/hexo-tag-echarts3)æ˜¯ä¸€æ¬¾åœ¨Hexoåšå®¢ä¸­å¯¼å…¥echartså›¾è¡¨çš„æ’ä»¶ã€‚ä½†æ˜¯å®ƒä¸æ”¯æŒå¯¼å…¥åœ°å›¾ï¼ŒåŒæ—¶è¯¥æ’ä»¶è¦æ±‚æ‰€æœ‰æ¸²æŸ“çš„ä»£ç éƒ½å¿…é¡»åœ¨`option`çš„å†…éƒ¨ï¼ˆå˜é‡`option`ä¸€èˆ¬ç”¨äºæŒ‡å®šäº†å›¾è¡¨çš„é…ç½®é¡¹å’Œæ•°æ®ï¼‰ã€‚å¦‚æœæœ‰è°ƒç”¨å¤–éƒ¨å‡½æ•°ã€å¤–éƒ¨å˜é‡çš„æƒ…å†µï¼Œæ•ˆæœå¯èƒ½å°±ä¸å¤ªå¥½ã€‚æ‰€ä»¥å¯¹æ’ä»¶è¿›è¡Œäº†ä¿®æ”¹ï¼Œæ”¯æŒäº†åœ°å›¾åŠŸèƒ½ï¼ŒåŒæ—¶æ”¹è¿›äº†æ¸²æŸ“æœºåˆ¶ï¼Œå³æ¸²æŸ“ä»£ç åªå«æœ‰`option`ï¼Œæˆ–è€…é™¤`option`å¤–è¿˜è°ƒç”¨äº†å¤–éƒ¨çš„å‡½æ•°çš„æƒ…å†µéƒ½å¯ä»¥æˆåŠŸæ‰§è¡Œã€‚\n\n<br/>\n## æ’ä»¶ä¿®æ”¹\n### å¼•å…¥åœ°å›¾\né¦–å…ˆéœ€è¦ä¿®æ”¹å¼•å…¥çš„`echarts`æ–‡ä»¶ï¼Œå› ä¸º`echarts`é€šç”¨åŒ…ä¸­ä¸å«æœ‰åœ°å›¾ç»„ä»¶ï¼Œæ‰€ä»¥å¿…é¡»ä½¿ç”¨å®Œæ•´åŒ…æˆ–è€…[åœ¨çº¿å®šåˆ¶](http://echarts.baidu.com/builder.html)çš„æ–¹å¼\n```JavaScript\n<script type=\"text/javascript\" src=\"https://cdn.bootcss.com/echarts/4.2.0-rc.2/echarts.min.js\"></script>\n```\n\nå¦Echartsç°åœ¨ä¸èƒ½å¤Ÿç›´æ¥ä¸‹è½½åœ°å›¾ï¼Œæ‰€ä»¥éœ€è¦èƒ½å¤Ÿæ‰¾åˆ°å¤–éƒ¨åœ°å›¾jsæ–‡ä»¶ã€‚å¯ä»¥ä»githubä¸Šä¸‹è½½[China.js](https://github.com/apache/incubator-echarts/blob/master/map/js/china.js)å†ä»æœ¬åœ°å¯¼å…¥ã€‚\nä¾‹å¦‚ï¼šä¸‹è½½åˆ°`/themes/ä¸»é¢˜å/source/js/`ä¸­ï¼Œå¯¼å…¥æ–¹å¼ä¸ºï¼š\n```JavaScript\n<script type=\"text/javascript\" src=\"/js/echarts.js\"></script>\n```\næˆ–è€…å¼•ç”¨çº¿ä¸Šæ–‡ä»¶ï¼š\n```JavaScript\n<script type=\"text/javascript\" src=\"http://gallery.echartsjs.com/dep/echarts/map/js/china.js\"></script>\n```\n**æ³¨æ„ï¼š**æ ¹æ®`<script>`åŠ è½½æœºåˆ¶ï¼Œå¼•ç”¨é¡ºåºå¿…é¡»å…ˆå¼•å…¥`echarts.js`ï¼Œåè½½å…¥åœ°å›¾jsæ–‡ä»¶\n\n<br/>\n### ä¿®æ”¹æ¸²æŸ“æ–¹å¼\nä¿®æ”¹æ¨¡æ¿æ–‡ä»¶`template.html`ä»£ç \n```javascript\n<script type=\"text/javascript\">\n  // åŸºäºå‡†å¤‡å¥½çš„domï¼Œåˆå§‹åŒ–echartså®ä¾‹\n  var myChart = echarts.init(document.getElementById('<%- id %>'));\n  // æŒ‡å®šå›¾è¡¨çš„é…ç½®é¡¹å’Œæ•°æ®\n  <%= sourceCode %>\n  // ä½¿ç”¨åˆšæŒ‡å®šçš„é…ç½®é¡¹å’Œæ•°æ®æ˜¾ç¤ºå›¾è¡¨ã€‚\n  myChart.setOption(option);\n</script>\n```\n\nä¿®æ”¹`index.js`æ–‡ä»¶\n```JavaScript\nfunction echartsMaps(args, content) {\n    var template = fs.readFileSync(filePath).toString(),\n        options = {};\n    if (content.length) {\n        var options = content;\n    }\n    return _.template(template)({\n        id: 'echarts' + ((Math.random() * 9999) | 0),\n        sourceCode: content,\n        height: args[0] || 400,\n        width: args[1] || '85%'\n    });\n}\n```\nå…¶ä¸­å‚æ•°`content`ä¸ºåµŒå…¥çš„ä»£ç ï¼Œä»¥ä¸Šä¿®æ”¹ä¼šå°†åµŒå…¥çš„ä»£ç ç›´æ¥æ¸²æŸ“ï¼Œä¹‹åè°ƒç”¨`myChart.setOption(option);`ä½¿ç”¨é…ç½®é¡¹å’Œæ•°æ®æ˜¾ç¤ºå›¾è¡¨ã€‚\n<br/>\n## æ¸²æŸ“å›¾\n\n![è¶³è¿¹](https://cdn.jsdelivr.net/gh/Cloving/Atlas-Github/blog/notePicture/hexo-tag-echarts-chartæ’ä»¶/è¶³è¿¹.png)\n\n<br/>\n## æ€»ç»“\næœ¬æ–‡å™è¿°äº†å¦‚ä½•å°†`Echarts`çš„å›¾è¡¨åµŒå…¥åˆ°blogä¸­ï¼Œç”±äºæˆ‘éœ€è¦ä½¿ç”¨è¶³è¿¹åœ°å›¾å¹¶ä¸”ä¼šè°ƒç”¨`option`å¤–éƒ¨çš„å‡½æ•°ï¼Œæ‰€ä»¥ä¿®æ”¹äº†åŸæ¥çš„æ’ä»¶ã€‚ä¿®æ”¹åçš„æ’ä»¶åœ°å€ï¼š[hexo-tag-echarts-chart](https://github.com/Cloving/hexo-tag-echarts-chart)ï¼Œæ¬¢è¿è¯•ç”¨ã€‚\n\n<br/>\n## å‚è€ƒæ–‡çŒ®\n1ã€[ä½¿ç”¨ ECharts3.0 åœ¨ Hexo æ­å»ºçš„åšå®¢ä¸­å»ºä¸€ä¸ªè¶³è¿¹ğŸ‘£é¡µé¢ | Docle ã® Blog](https://docle.github.io/2018/04/06/Use-ECharts-To-Build-A-[footprint]-Page/)\n2ã€[åœ¨ Hexo ä¸­æ’å…¥ ECharts åŠ¨æ€å›¾è¡¨ - KChen's Blog](https://kchen.cc/2016/11/05/echarts-in-hexo/)\n3ã€[è°ˆè°ˆscriptæ ‡ç­¾ä»¥åŠå…¶åŠ è½½é¡ºåºé—®é¢˜ï¼ŒåŒ…å« defer async  - ä¸ªäººæ–‡ç«  - SegmentFault æ€å¦](https://segmentfault.com/a/1190000013615988)\n4ã€[æµè§ˆå™¨åŠ è½½ JS æ–‡ä»¶çš„å…ˆåé¡ºåºåŒå…·ä½“çš„è§£æå’Œæ‰§è¡Œæœ‰ä»€ä¹ˆå…³ç³»ï¼Ÿ - çŸ¥ä¹](https://www.zhihu.com/question/20531965)\n5ã€[kchen0x/hexo-tag-echarts3: A simple plugin for inserting ECharts 3 by using tags in Hexo](https://github.com/kchen0x/hexo-tag-echarts3)\n<br/>\n\n","tags":["Echarts","Javascript"],"categories":["å»ºç«™å®å½•","è¶³è¿¹å›¾"]},{"title":"Pythonæ¨¡æ‹Ÿè±†ç“£ç™»å½•ï¼ˆä¸€ï¼‰","url":"/2018/11/30/Pythonæ¨¡æ‹Ÿè±†ç“£ç™»å½•ï¼ˆä¸€ï¼‰/","content":"<br/>\n# æ‘˜è¦\næŠ“å–æ•°æ®çš„è¿‡ç¨‹ä¸­æœ‰æ—¶å€™éœ€è¦å®Œæˆæ¨¡æ‹Ÿç™»å½•çš„æ“ä½œï¼Œæœ¬æ–‡ä½¿ç”¨`requests`åº“å®Œæˆè±†ç“£çš„æ¨¡æ‹Ÿç™»å½•ï¼Œå¹¶ä¿å­˜å·²ç™»å½•çš„Cookieï¼Œæ–¹ä¾¿ä¸‹æ¬¡ç›´æ¥ç™»å½•ã€‚ä¹‹åé€šè¿‡è®¿é—®ä¸ªäººä¸»é¡µéªŒè¯å½“å‰çŠ¶æ€æ˜¯å¦ä¸ºå·²ç™»å½•çŠ¶æ€ã€‚\n\n![ç™»å½•é¡µé¢](https://cdn.jsdelivr.net/gh/Cloving/Atlas-Github/blog/notePicture/è±†ç“£ç™»å½•ï¼ˆä¸€ï¼‰/ç™»å½•é¡µé¢.png)\n\n<br/>\n# requestsè¯·æ±‚\n\n## åˆ†æè¿‡ç¨‹\né¦–å…ˆéœ€è¦ç ”ç©¶è±†ç“£çš„ç™»å½•æœºåˆ¶ï¼Œåœ¨è±†ç“£çš„ç™»å½•ç•Œé¢æŸ¥çœ‹ç™»å½•è¯·æ±‚æäº¤çš„è¡¨å•é¡¹ï¼Œå¦‚å›¾æ‰€ç¤ºï¼š\n\n![ç™»å½•è¡¨å•](https://cdn.jsdelivr.net/gh/Cloving/Atlas-Github/blog/notePicture/è±†ç“£ç™»å½•ï¼ˆä¸€ï¼‰/ç™»å½•è¡¨å•.png)\n\nå›¾ä¸­çš„`Login`è¯·æ±‚ä¸ºpostç±»å‹ï¼Œ`Form Data`è¡¨ç¤ºpoståˆ°æœåŠ¡å™¨çš„æ•°æ®ï¼Œå¯ä»¥çœ‹å‡ºæ•°æ®å¹¶æœªåŠ å¯†ã€‚\n\n1ã€`source`è¡¨ç¤ºè¯¥ç™»å½•é¡µé¢æ˜¯ç”±è±†ç“£è¯»ä¹¦è·³è½¬è¿‡æ¥\n2ã€`redir`è¡¨ç¤ºç™»å½•åè·³è½¬åˆ°çš„url\n3ã€`form_email`å’Œ`form_password`åˆ†åˆ«è¡¨ç¤ºç”¨æˆ·åå’Œå¯†ç \n4ã€`captcha-solution`åˆ™æ˜¯éªŒè¯ç \n5ã€`captcha-id`éªŒè¯ç çš„idè¯¥å­—æ®µå¯ä»ç™»å½•é¡µé¢çš„HTMLä¸­è·å–\n\n## ç¼–ç è¿‡ç¨‹\n### 1ã€åˆå§‹åŒ–å˜é‡ï¼š\n```Python\ndef __init__(self):\n  self.session = requests.Session()  \n  self.session.cookies = cookielib.LWPCookieJar(filename=\"cookies.txt\")  \n  self.url = 'https://accounts.douban.com/login'  # ç™»å½•url\n  self.redirurl = 'https://book.douban.com/mine'  # é‡å®šå‘url\n  self.email = '******'             \n  self.password = '******'\n  # æ„é€ postæ•°æ®\n  self.data = {\n    'redir': self.redirurl,\n    'form_email': self.email,\n    'form_password': self.password,\n    'login': 'ç™»å½•'\n  }\n  # æ„é€ ç”¨æˆ·ä»£ç†\n  self.headers = {\n    'User-Agent': 'Mozilla/5.0 '\n    '(Windows NT 10.0; Win64; x64) '\n    'AppleWebKit/537.36 (KHTML, like Gecko) '\n    'Chrome/55.0.2883.87 Safari/537.36'\n  }\n```\n\n### 2ã€å‘é€è¯·æ±‚\næˆ‘ä»¬æ¨¡æ‹Ÿç™»å½•éœ€è¦çš„æ˜¯ç™»å½•ä¹‹åçš„é¡µé¢ï¼Œæ‰€ä»¥åˆ©ç”¨`Session`æ¥ç»´æŒä¸€ç§ä¼šè¯çŠ¶æ€ï¼Œå¹¶ä¸”ä¿å­˜ç™»å½•åçš„`Cookie`ã€‚ä¸‹æ¬¡ç™»å½•æ—¶ç›´æ¥æºå¸¦`Cookie`å‘é€è¯·æ±‚ï¼Œæ— éœ€å†ä½¿ç”¨è´¦å·å¯†ç ã€‚åˆ¤æ–­ç™»å½•æ—¶æ˜¯å¦éœ€è¦éªŒè¯ç å…ˆä½¿ç”¨`BeautifulSoup`åº“æ¥è·å–ç™»å½•é¡µé¢çš„`HTML`ä»£ç ï¼Œä¹‹ååˆ©ç”¨æ­£åˆ™è¡¨è¾¾å¼åˆ¤æ–­å…¶ä¸­æ˜¯å¦æœ‰æ˜¾ç¤ºéªŒè¯ç çš„`img`æ ‡ç­¾ï¼Œå¦‚æœæœ‰å¤„ç†éªŒè¯ç ï¼Œå¦‚æœæ²¡æœ‰é‚£ä¹ˆå°±å°†å·²æœ‰çš„ä¿¡æ¯poståˆ°æœåŠ¡å™¨ï¼Œå¹¶ä¿å­˜ç™»å½•åçš„Cookieã€‚\n\n```Python\ndef login(self):\n  page = self.session.post(self.url, headers=self.headers)\n  soup = BeautifulSoup(page.text, \"html.parser\")\n  captcha = soup.find('img', id='captcha_image')\n  if captcha is not None:\n    self.process_captcha(page, captcha)\n    afterLogin_page = self.session.post(self.url, data=self.data, headers=self.headers)\n  else:\n    afterLogin_page = self.session.post(self.url, data=self.data, headers=self.headers)\n  # print(self.session.cookies)\n  self.session.cookies.save(ignore_discard=True, ignore_expires=True)\n  print(afterLogin_page.text)\n  soup = BeautifulSoup(afterLogin_page.text, \"html.parser\")\n```\n\n#### å…³äºCookieä¸Session\nHttpæ˜¯ä¸€ç§æ— çŠ¶æ€çš„åè®®ï¼Œå› æ­¤å¹¶ä¸èƒ½è¿½è¸ªç”¨æˆ·çš„çŠ¶æ€ï¼Œæ‰€ä»¥å¸¸é‡‡ç”¨`Session`ä¸`Cookie`ç»“åˆçš„æ–¹å¼è·Ÿè¸ªç”¨æˆ·çš„çŠ¶æ€ã€‚`Session`ä½äºæœåŠ¡å™¨ç«¯åªä¿å­˜å¯¹è¯ä¿¡æ¯ä½†æ˜¯ä¸èƒ½å¤Ÿè¯†åˆ«å‡ºå…·ä½“çš„ç”¨æˆ·ï¼Œ`Cookie`ä½äºå®¢æˆ·ç«¯ç”¨äºå­˜æ”¾ç”¨æˆ·ä¿¡æ¯ã€‚`Cookie`åœ¨ç™»å½•ç½‘ç«™æ—¶ä¼šç”±æœåŠ¡å™¨äº§ç”Ÿä¼ é€’ç»™å®¢æˆ·ç«¯ï¼Œå½“å®¢æˆ·ç«¯å†æ¬¡ç™»å½•æ—¶ä¼šæºå¸¦`Cookie`ï¼Œä¹‹åæœåŠ¡å™¨ä¾¿æ ¹æ®`Cookie`ä¸­çš„`Session ID`è·Ÿè¸ªåˆ°ä¼šè¯ã€‚å¦‚æœä¼šè¯æœ‰æ•ˆï¼Œé‚£ä¹ˆä¼šåˆ¤æ–­ç”¨æˆ·å·²å¤„äºç™»å½•çŠ¶æ€ï¼Œå¦åˆ™å¯èƒ½ä¼šåˆ¤æ–­ç”¨æˆ·æ²¡æœ‰è®¿é—®æƒé™è¿›è€Œè·³è½¬åˆ°ç™»å½•é¡µé¢ã€‚\nåŒæ—¶Cookieæ˜¯æœ‰è¿‡æœŸæ—¶é—´çš„ï¼Œè¶…è¿‡è¯¥æ—¶é—´Cookieå¤±æ•ˆï¼Œéœ€è¦é‡æ–°è·å–ã€‚è¿™åŒæ—¶ä¹Ÿæ˜¯ä¸ºäº†é¿å…Cookieè¢«ä»–äººè·å–å¹¶é•¿æœŸä½¿ç”¨ã€‚\n\n### 3ã€å¤„ç†éªŒè¯ç \nè¿™é‡Œå…ˆä½¿ç”¨æ‰‹åŠ¨è¾“å…¥éªŒè¯ç çš„æ–¹å¼ï¼Œé¦–å…ˆæ‹¿åˆ°éªŒè¯ç å›¾ç‰‡çš„åœ°å€ï¼ˆè¿™ä¸ªåœ°å€æ˜¯ä¸´æ—¶çš„ï¼Œä¸€æ®µæ—¶é—´åä¼šå¤±æ•ˆï¼Œä½†å¯¹äºæ‰‹åŠ¨è¾“å…¥å¹¶ä¸å½±å“ï¼‰ï¼Œç„¶ååˆ©ç”¨æ­£åˆ™è¡¨è¾¾å¼æ‹¿åˆ°`captcha-id`ï¼Œå› ä¸ºå®ƒéœ€è¦ä¸éªŒè¯ç ä¸€åŒpoståˆ°æœåŠ¡å™¨ã€‚å…·ä½“ä»£ç å¦‚ä¸‹ï¼š\n\n```Python\n  def process_captcha(self, page, captcha):\n    # å¤„ç†éªŒè¯ç \n    # è·å¾—éªŒè¯ç å›¾ç‰‡åœ°å€\n    captcha_url = captcha['src']\n    # åˆ©ç”¨æ­£åˆ™è¡¨è¾¾å¼è·å¾—éªŒè¯ç ID\n    pattern = re.compile('<input type=\"hidden\" name=\"captcha-id\" value=\"(.*?)\"/')\n    captcha_id = re.search(pattern, page.text).group(1)\n    # å°†éªŒè¯ç å›¾ç‰‡ä¿å­˜åˆ°æœ¬åœ°\n    urllib.request.urlretrieve(captcha_url, \"captcha.png\")\n    try:\n      image = Image.open('captcha.png')\n      image.show()\n      image.close()\n    except Exception as e:\n      print(\"æ‰“å¼€éªŒè¯ç å›¾ç‰‡å¤±è´¥ï¼Œè¯·æ‰‹åŠ¨é‡è¯•\")\n    captcha = input('please input the captcha:')\n    self.data['captcha-solution'] = captcha\n    self.data['captcha-id'] = captcha_id\n```\n\n### 4ã€åˆ©ç”¨Cookieç™»å½•\nè½½å…¥æœ¬åœ°Cookieä¹‹åå†å‘é€getè¯·æ±‚åˆ°urlï¼Œä¹‹åå°†è¯·æ±‚åˆ°çš„`HTML`æ–‡æœ¬å†™å…¥æ–‡ä»¶ã€‚\n**æ³¨æ„ï¼š**ä»¥äºŒè¿›åˆ¶çš„ç±»å‹å†™å…¥éœ€è¦byteså¯¹è±¡ï¼Œæ‰€ä»¥ä½¿ç”¨`utf8`ç¼–ç \n```Python\ndef get_index(self):\n  # æ ¹æ®æœ¬åœ°cookiesç™»å½•\n  try:\n    self.session.cookies.load(ignore_discard=True)\n  except Exception as e:\n    print(\"cookieæœªèƒ½åŠ è½½, åŸå› : \", e)\n  response = self.session.get(self.redirurl, headers=self.headers)\n  with open(\"index.html\", 'wb') as f:\n    f.write(response.text.encode('utf8'))\n  print(\"å·²è½½å…¥æœ¬åœ°Cookie\")\n```\n\n# æ€»ç»“\nè¿‡ç¨‹æ¯”è¾ƒç®€å•ï¼Œç¼–ç è¿‡ç¨‹ä¹Ÿä¸å¤æ‚ï¼ŒéªŒè¯ç çš„å¤„ç†æš‚æ—¶ä½¿ç”¨æ‰‹åŠ¨çš„æ–¹å¼ã€‚å…³äºè‡ªåŠ¨è¯†åˆ«è±†ç“£éªŒè¯ç çš„æ–¹å¼æ­£åœ¨ç ”ç©¶ä¸­ï¼Œç›®å‰æ•ˆæœè¿˜ä¸ç†æƒ³ã€‚\nå®Œæ•´ä»£ç ï¼š[douban_login_1.py](https://github.com/Cloving/Douban-Spider/blob/master/%E8%B1%86%E7%93%A3%E7%99%BB%E5%BD%95/douban_login_1.py)\n\n# å‚è€ƒæ–‡çŒ®\n1ã€[python çˆ¬è™« cookie çš„ä¿å­˜å’ŒåŠ è½½ - ç›–å¨… - å¼€æºä¸­å›½](https://my.oschina.net/sukai/blog/662046)\n2ã€[Pythonçˆ¬è™«åŸºç¡€ç»ƒä¹ (åä¸€)ç®€å•æ¨¡æ‹Ÿè±†ç“£ç™»å½• - çŸ¥ä¹](https://zhuanlan.zhihu.com/p/38191385)\n<br/>\n","tags":["Python","éªŒè¯ç ","æ¨¡æ‹Ÿç™»å½•","æ­£åˆ™è¡¨è¾¾å¼"],"categories":["æ•°æ®æŠ“å–","è±†ç“£"]},{"title":"æŠ“å–çŸ¥ä¹ç”¨æˆ·åŠ¨æ€æ•°æ®","url":"/2018/11/20/æŠ“å–çŸ¥ä¹ç”¨æˆ·åŠ¨æ€æ•°æ®/","content":"\n<br />\n## ä¸€ã€ç®€ä»‹\næ‰“å¼€çŸ¥ä¹æŸä¸ªç”¨æˆ·çš„ä¸»é¡µå¯ä»¥çœ‹åˆ°è¯¥ç”¨æˆ·èµåŒå›ç­”ã€å…³æ³¨ä¸“æ ã€å…³æ³¨é—®é¢˜ç­‰è¡Œä¸ºæ•°æ®ã€‚æœ¬æ–‡åˆ©ç”¨Pythonçš„requestsåº“æŠ“å–çŸ¥ä¹ç”¨æˆ·è¡Œä¸ºæ•°æ®å¹¶å­˜å…¥MongoDBæ•°æ®åº“ä¸­ã€‚\n<br/>\n## äºŒã€åˆ†ææ•°æ®åŠ è½½æ–¹å¼\n1. æ‰“å¼€ç½‘é¡µåå‘ä¸‹æ‹‰å–å¯ä»¥è§‚å¯Ÿåˆ°è¡Œä¸ºæ•°æ®å¹¶ä¸æ˜¯ä¸€æ¬¡åŠ è½½å®Œï¼Œè€Œæ˜¯éšç€ç”¨æˆ·çš„æµè§ˆè¿›åº¦é€æ­¥åŠ è½½ï¼Œè€ƒè™‘å¯èƒ½æ˜¯ajaxçš„å½¢å¼ã€‚\n2. ä¹‹åæ‰“å¼€Chromeæ§åˆ¶å°åˆ†æç½‘ç»œé€‰é¡¹ï¼ŒæŸ¥çœ‹XHR(XMLHttpRequest)ç±»å‹çš„æ–‡ä»¶å¯ä»¥è§‚å¯Ÿå‡ºæ”¶åˆ°çš„å“åº”æ˜¯jsonæ•°æ®ï¼Œå…¶ä¸­åŒ…å«äº†ç”¨æˆ·è¡Œä¸ºæ•°æ®çš„ç›¸å…³ä¿¡æ¯\n\n![å›¾1](https://cdn.jsdelivr.net/gh/Cloving/Atlas-Github/blog/notePicture/æŠ“å–çŸ¥ä¹ç”¨æˆ·åŠ¨æ€æ•°æ®/çŸ¥ä¹åˆ†æ1.png)\n\næ‰€ä»¥é¦–å…ˆéœ€è¦è¯·æ±‚åˆ°ç½‘ç«™è¿”å›çš„jsonæ•°æ®ï¼Œç„¶åå¯¹æ•°æ®è¿›è¡Œè§£æï¼Œç»“æ„åŒ–å¤„ç†ï¼Œå­˜å…¥MongoDBä¸­ã€‚\n<br/>\n## ä¸‰ã€ä»£ç åˆ†æ\n### 1ã€åˆå§‹åŒ–å˜é‡\n```python\n  def __init__(self):\n    self.user_name = \"******\"\n    self.max_search_counts = **\n    self.params = {\n      \"limit\": 7,\n      \"desktop\": \"True\"\n    }\n    self.base_url = \"https://www.zhihu.com/api/v4/members/\"\n    self.url = self.base_url + '/' + self.user_name + '/activities?' + urlencode(self.params)\n\n    self.headers = {\n      \"User-Agent\": \"Mozilla/5.0 (X11; Linux x86_64)\\\n                    AppleWebKit/537.36 (KHTML, like Gecko)\\\n                    Chrome/70.0.3538.77 Safari/537.36\",\n      \"Referer\": \"https://www.zhihu.com/\",\n      \"x-requested-with\": \"fetch\"\n    }\n    self.client = MongoClient('127.0.0.1',username='admin',\n                        password='******',\n                        authSource='admin',\n                        authMechanism='SCRAM-SHA-1')\n    self.db = self.client[\"zhihu\"]\n    self.collection = self.db[\"zhihuDynamic\"]\n```\n\n1ã€`user_name`å¹¶ä¸æ˜¯ç”¨æˆ·çš„çŸ¥ä¹IDï¼Œè€Œæ˜¯ç”¨æˆ·çš„ä¸ªæ€§åŒ–åŸŸåã€‚æ¯”å¦‚çŸ¥ä¹å°ç®¡å®¶çš„ä¸ªæ€§åŒ–åŸŸåä¸º`zhihuadmin`ï¼Œè¿™å¯ä»¥é€šè¿‡è§‚å¯Ÿç”¨æˆ·ä¸»é¡µçš„urlè·å¾—\n2ã€è¯·æ±‚çš„urlå°±æ˜¯è¿”å›jsonæ•°æ®ï¼Œåœ¨æ§åˆ¶å°çš„`Network`é€‰é¡¹ä¸­è§‚å¯Ÿåˆ°è¿”å›`json`æ•°æ®çš„`url`ç±»ä¼¼äºä»¥ä¸‹å½¢å¼ï¼š\n```html\nhttps://www.zhihu.com/api/v4/members/zhihuadmin/activities?limit=7&after_id=1542365521&desktop=True\n```\nåˆ†æç»„æˆå¯ä»¥çœ‹å‡º`https://www.zhihu.com/api/v4/members/`ä¸ºé€šç”¨éƒ¨åˆ†ã€‚`zhihuadmin`ä¸ºç”¨æˆ·çš„ä¸ªæ€§åŒ–åŸŸåã€‚?ä¹‹åæ˜¯æºå¸¦çš„å‚æ•°\n3ã€æŠ“å–çŸ¥ä¹çš„æ•°æ®å¿…é¡»æºå¸¦ç”¨æˆ·ä»£ç†ã€‚\n\n### 2ã€å¼€å§‹æŠ“å–\n```Python\ndef startSearch(self):\n  for search_times in range(0, self.max_search_counts):\n    json = self.get_Page(self.url)\n    try:\n      self.url = json.get(\"paging\").get(\"next\")\n      print(self.url)\n    except Exception as e:\n      print(\"è·å–ä¸‹ä¸€æ¬¡è¯·æ±‚çš„é“¾æ¥å¤±è´¥ï¼Œå¤±è´¥åŸå› ï¼š\", e)\n    results = self.get_Parse(json)\n    print(\"=======================================\")\n    for result in results:\n      self.save_to_mongodb(result)\n```\n`for`å¾ªç¯æ§åˆ¶æœç´¢æ¬¡æ•°ï¼Œæ¯æ¬¡æœç´¢ä¼šæŠ“å–7æ¡æ•°æ®å³7æ¬¡åŠ¨æ€ã€‚ä¹‹åæå–å‡ºæœ¬æ¬¡æŠ“å–åˆ°jsonæ•°æ®ä¸­çš„ç”¨æˆ·åŠ¨æ€ä¿¡æ¯ï¼Œå¹¶æ›´æ–°ä¸‹ä¸€æ¬¡æœç´¢çš„urlï¼Œå¹¶å°†æå–å‡ºçš„æ•°æ®å­˜å…¥MongoDBä¸­\n\n### 3ã€æŠ“å–jsonæ•°æ®\n```Python\n# è·å–jsonæ•°æ®\ndef get_Page(self, url):\n  try:\n    response = requests.get(url, headers=self.headers)\n    if response.status_code == 200:\n      return response.json()\n  except requests.ConnectionError as e:\n    print(\"Error: \", e.args)\n```\nä¼ å…¥é¡µé¢çš„url,è¿”å›ç›¸åº”çš„jsonæ•°æ®\n\n\n### 4ã€è§£æjsonæ•°æ®\n\næ ¹æ®ä¼ å…¥jsonæ•°æ®çš„æ ¼å¼ï¼Œæå–ç”¨æˆ·çš„å„é¡¹åŠ¨æ€\n![jsonæ•°æ®ç¤ºæ„å›¾]( https://cdn.jsdelivr.net/gh/Cloving/Atlas-Github/blog/notePicture/æŠ“å–çŸ¥ä¹ç”¨æˆ·åŠ¨æ€æ•°æ®/çŸ¥ä¹json.png)\n\n```Python\n# è§£æjsonæ•°æ®\ndef get_Parse(self, json):\n  if json:\n    items = json.get('data')\n    for item in items:\n      zhihu = {}\n      action_text = item.get(\"action_text\")\n      created_time = item.get(\"created_time\")\n      zhihu[\"æ“ä½œè¡Œä¸º\"] = action_text\n      zhihu[\"æ—¶é—´\"] = time.strftime(\"%Y-%m-%d %H:%M:%S\", time.localtime(created_time))\n      if item.get('verb') == \"MEMBER_VOTEUP_ARTICLE\":\n        item_detail =  voteup_article(item.get(\"target\"))\n      elif item.get('verb') == \"ANSWER_VOTE_UP\":\n        item_detail = answer_voteUp(item.get(\"target\"))\n      elif item.get('verb') == \"MEMBER_CREATE_ARTICLE\":\n        item_detail =  create_article(item.get(\"target\"))\n      elif item.get('verb') == \"MEMBER_FOLLOW_COLUMN\":\n        item_detail =  follow_column(item.get('target'))\n      elif item.get('verb') == \"ANSWER_CREATE\":\n        item_detail = answer_create(item.get('target'))\n      elif item.get('verb') == \"QUESTION_FOLLOW\":\n        item_detail = question_follow(item.get('target'))\n      yield dict(zhihu, **item_detail)\n```\n\n### 5ã€å°†è§£æå‡ºæ¥çš„æ•°æ®å¯¼å…¥åˆ°æ•°æ®åº“ä¸­\n```Python\n  # å¯¼å…¥åˆ°jsonæ•°æ®åº“ä¸­\n  def save_to_mongodb(self, result):\n    if self.collection.insert_one(result):\n      print(\"Successful save to Mongodb\")\n```\n<br/>\n## å››ã€æ€»ç»“\nä»£ç å†™çš„å¹¶ä¸å¥½ï¼Œä»…ä½œä¸ºå‚è€ƒã€‚å®Œæ•´ä»£ç : [ç‚¹è¿™é‡Œ](https://github.com/Cloving/zhihu-Spider/tree/master/%E7%9F%A5%E4%B9%8E%E7%94%A8%E6%88%B7%E5%8A%A8%E6%80%81)\n<br/>\n## å‚è€ƒæ–‡çŒ®\n### 1ã€[Authentication Examples â€” PyMongo 3.7.2 documentation](http://api.mongodb.com/python/current/examples/authentication.html)\n### 2ã€[Ajaxç»“æœæå– â€” Python3ç½‘ç»œçˆ¬è™«å¼€å‘å®æˆ˜](https://germey.gitbooks.io/python3webspider/content/6.3-Ajax%E7%BB%93%E6%9E%9C%E6%8F%90%E5%8F%96.html)\n### 3ã€[çŸ¥ä¹å°ç®¡å®¶ â€” çŸ¥ä¹](https://www.zhihu.com/people/zhihuadmin/activities)\n<br/>\n","tags":["Python","ajax","MongoDB"],"categories":["æ•°æ®æŠ“å–","çŸ¥ä¹"]},{"title":"ä¸‰å¯¸æ°”åœ¨åƒèˆ¬ç”¨ï¼Œä¸€æ—¦æ— å¸¸ä¸‡äº‹ä¼‘","url":"/2018/09/21/ä¸‰å¯¸æ°”åœ¨åƒèˆ¬ç”¨ï¼Œä¸€æ—¦æ— å¸¸ä¸‡äº‹ä¼‘/","content":"\n<iframe frameborder=\"no\" border=\"0\" marginwidth=\"0\" marginheight=\"0\" width=330 height=86 src=\"//music.163.com/outchain/player?type=2&id=574919767&auto=1&height=66\"></iframe>\n\n<br/>\n## å…¶å®äººç”Ÿå¾ˆé•¿ï¼Œ\n### é€‰æ‹©ä¸€ä¸ªè‡ªå·±çœŸæ­£æƒ³è¦ä»äº‹çš„é¢†åŸŸï¼Œæ²‰æ·€ä¸‹å»ï¼ŒæŠŠè‡ªå·±å˜å¾—æ›´å‰å®³ä¸€ç‚¹ã€‚\n### å› ä¸ºå¯¹äºäººæ¥è¯´ä¸æ€•æœ‰ç¼ºç‚¹ï¼Œå°±æ€•æ²¡ç‰¹ç‚¹ã€‚\n### ä½†ä¸è¦æƒ³ç€ä¸€å®šè¦æ¯”è°è°æ›´å¥½ï¼Œå› ä¸ºä¸è®ºä½ å¤šåŠªåŠ›ï¼Œæ€»æœ‰äººæ¯”ä½ å‰å®³ï¼Œä¹Ÿæ€»æœ‰äººæ°¸è¿œä¸å¦‚ä½ ã€‚\n### å’Œåˆ«äººæ¯”è¾ƒå¤§æ¦‚æ˜¯ç”Ÿè€Œä¸ºäººæœ€å¯æ‚²çš„äº‹ã€‚\n### æ€»è€Œè¨€ä¹‹ï¼Œä¸åº”å½“æœ‰å¤ªå¤šçš„æ¬²æœ›ï¼Œä¸è¦åšäº†ä¸€ä»¶äº‹å°±å¿…é¡»è¦å¾—åˆ°ä»€ä¹ˆã€‚ä½†è¡Œå¥½äº‹ï¼Œè«é—®å‰ç¨‹ã€‚\n<br/>\n## å…¶å®äººç”Ÿä¹Ÿå¾ˆçŸ­ï¼Œ\n### ç”Ÿå‘½æ˜¯è„†å¼±çš„ï¼Œä¸€æ¬¡çœ‹ä¼¼æ™®é€šçš„ç†¬å¤œä¹Ÿè®¸å°±æ¦¨å¹²äº†ä½ å…¨éƒ¨çš„ç²¾åŠ›ï¼Œ\n### ä¸€æ¬¡çœ‹ä¼¼æ™®é€šçš„ç–¾ç—…ä¹Ÿè®¸ä¼šæ¢æ¥äº†ä¸€å¼ è–„è–„çš„ç—…å±é€šçŸ¥ä¹¦ã€‚\n### çè§†è‡ªå·±ï¼Œçè§†çè§†ä½ çš„äººï¼Œä¸åšè®©è‡ªå·±åæ‚”çš„äº‹ã€‚\n<br/>\n<br/>","tags":["å¿µå¿µä¸å¿˜ï¼Œå¿…æœ‰å›å“"],"categories":["å¿µå¿µä¸å¿˜ï¼Œå¿…æœ‰å›å“"]},{"title":"äºŒåˆ†æœç´¢ç®—æ³•","url":"/2018/06/13/äºŒåˆ†æœç´¢ç®—æ³•/","content":"\n\n## 1.1 åŸºæœ¬çš„äºŒåˆ†æœç´¢(é€’å½’)\n\n\n```c++\n// æ™®é€šäºŒåˆ†ï¼šé€’å½’\nint BSearch1(vector<int> ve, int target) {\n  int left = 0, right = ve.size()-1;\n  if (left > right) {\n    return -1;\n  }\n  int mid = left + (right - left) / 2;\n  if (ve[mid] > target) {\n    return BSearch1(ve, target);\n  } else if (ve[mid] < target) {\n    return BSearch1(ve, target);\n  }\n  return ve[mid];\n}\n```\n\n## 1.2 åŸºæœ¬çš„äºŒåˆ†æœç´¢ï¼ˆå¾ªç¯ï¼‰\n\n```c++\n// æ™®é€šäºŒåˆ†ï¼šå¾ªç¯\nint BSearch2(vector<int> ve, int target) {\n  int left = 0, right = ve.size()-1;\n  while (left <= right) {\n    int mid = left + (right - left) / 2;\n    if (ve[mid] > target) {\n      right = mid - 1;\n    } else if (ve[mid] < target) {\n      left = mid + 1;\n    } else {\n      return ve[mid];\n    }\n  }\n}\n```\n\n## 2.1 æŸ¥æ‰¾ç¬¬ä¸€ä¸ªä¸targetç›¸ç­‰çš„å…ƒç´ çš„ç´¢å¼•\n\n```c++\nint BSearch3(vector<int> ve, int target) {\n  int left = 0, right = ve.size()-1;\n  while (left <= right) {\n    int mid = left + (right - left) / 2;\n    if (ve[mid] >= target) {\n      right = mid - 1;\n    } else {\n      left = mid + 1;\n    }\n  }\n  return ve[left] == target ? left : -1;\n}\n```\n\n## 2.2 æŸ¥æ‰¾æœ€åä¸€ä¸ªä¸targetç›¸ç­‰çš„å…ƒç´ çš„ç´¢å¼•\n\n```c++\nint BSearch4(vector<int> ve, int target) {\n  int left = 0, right = ve.size()-1;\n  while (left <= right) {\n    int mid = left + (right - left) / 2;\n    if (ve[mid] <= target) {\n      left = mid + 1;\n    } else {\n      right = mid - 1;\n    }\n  }\n  return ve[right] == target ? right : -1;\n}\n```\n\n## 2.3 æŸ¥æ‰¾æœ€åä¸€ä¸ªå°äºtargetçš„å…ƒç´ ç´¢å¼•\n\n```c++\nint BSearch5(vector<int> ve, int target) {\n  int left = 0, right = ve.size()-1;\n  while (left <= right) {\n    int mid = left + (right - left) / 2;\n    if (ve[mid] < target) {\n      left = mid + 1;\n    } else {\n      right = mid - 1;\n    }\n  }\n  return right;\n}\n\n```\n\n## 2.4 æŸ¥æ‰¾ç¬¬ä¸€ä¸ªå¤§äºtargetçš„å…ƒç´ ç´¢å¼•\n\n```c++\nint BSearch6(vector<int> ve, int target) {\n  int left = 0, right = ve.size()-1;\n  while (left <= right) {\n    int mid = left + (right - left) / 2;\n    if (ve[mid] > target) {\n      right = mid - 1;\n    } else {\n      left = mid + 1;\n    }\n  }\n  return left;\n}\n```\n\n## 2.5 æŸ¥æ‰¾æœ€åä¸€ä¸ªå°äºç­‰äºtargetçš„å…ƒç´ çš„ç´¢å¼•\n\n```c++\nint BSearch7(vector<int> ve, int target) {\n  int left = 0, right = ve.size()-1;\n  while (left <= right) {\n    int mid = left + (right - left) / 2;\n    if (ve[mid] <= target) {\n      left = mid + 1;\n    } else {\n      right = mid - 1;\n    }\n  }\n  return right;\n}\n```\n\n## 2.6 æŸ¥æ‰¾ç¬¬ä¸€ä¸ªå¤§äºç­‰äºtargetçš„å…ƒç´ çš„ç´¢å¼•\n\n```c++\nint BSearch8(vector<int> ve, int target) {\n  int left = 0, right = ve.size()-1;\n  while (left <= right) {\n    int mid = left + (right - left) / 2;\n    if (ve[mid] >= target) {\n      right = mid - 1;\n    } else {\n      left = mid + 1;\n    }\n  }\n  return left;\n}\n```\n\n## 2.7 æŸ¥æ‰¾targetæ‰€å¤„èŒƒå›´\n\n```c++\n// æŸ¥æ‰¾targetæ‰€å¤„èŒƒå›´ï¼Œæ²¡æœ‰è¿”å›-1\nvector<int> BSearch9(vector<int> vex, int target) {\n  vector<int> res;\n  int leftIndex = BSearch3(vex, target);\n  int rightIndex = BSearch4(vex, target);\n  res.push_back(leftIndex < 0 ? -1 : leftIndex);\n  res.push_back(rightIndex < 0 ? -1 : rightIndex);\n  return res;\n}\n```\n\n","tags":["æ•°æ®ç»“æ„","C++"],"categories":["æ•°æ®ç»“æ„ä¸ç®—æ³•","äºŒåˆ†æŸ¥æ‰¾"]},{"title":"Vueç”Ÿå‘½å‘¨æœŸè§£æ","url":"/2018/06/10/Vueç”Ÿå‘½å‘¨æœŸè§£æ/","content":"\n\n## ç®€ä»‹\n**å®šä¹‰**ï¼šæ¯ä¸ª `Vue` å®ä¾‹åœ¨è¢«åˆ›å»ºä¹‹å‰éƒ½è¦ç»è¿‡ä¸€ç³»åˆ—çš„åˆå§‹åŒ–è¿‡ç¨‹ã€‚ä¾‹å¦‚éœ€è¦è®¾ç½®æ•°æ®ç›‘å¬ã€ç¼–è¯‘æ¨¡æ¿ã€æŒ‚è½½å®ä¾‹åˆ° `DOM`ã€åœ¨æ•°æ®å˜åŒ–æ—¶æ›´æ–° `DOM` ç­‰ï¼Œä¸åŒçš„æ—¶æœŸå¯¹åº”ä¸åŒçš„å‘¨æœŸï¼›\n\n**ç”Ÿå‘½å‘¨æœŸå‡½æ•°ï¼š**ä¸åŒå‘¨æœŸå¼€æ”¾å‡ºæ¥çš„æ¥å£ï¼›\n\n![Vueç”Ÿå‘½å‘¨æœŸ](https://cdn.jsdelivr.net/gh/Cloving/Atlas-Github/blog/notePicture/Vueç”Ÿå‘½å‘¨æœŸ/Vueç”Ÿå‘½å‘¨æœŸå›¾.png)\n\n**Vueçš„ç”Ÿå‘½å‘¨æœŸå‡½æ•°ä¸»è¦åŒ…æ‹¬ä»¥ä¸‹å‡ ä¸ª:**\n\n1. beforeCreate ã€created \n2. beforeMount ã€mounted\n3. beforeUpdateã€  updated\n4. beforeDestroyã€destroyed  \n\n\n\n## æµç¨‹è§£è¯»\n\n**ç¬¬ä¸€æ­¥ï¼š**åˆå§‹åŒ–äº‹ä»¶å’Œç”Ÿå‘½å‘¨æœŸã€‚æ­¤æ—¶\\$dataã€\\$elå’Œmessageå‡å¤„äºundefinedçŠ¶æ€ã€‚ï¼ˆå‰ç¼€ `$`ï¼Œä»¥ä¾¿ä¸ç”¨æˆ·å®šä¹‰çš„å±æ€§åŒºåˆ†å¼€æ¥ï¼‰ã€‚\n\n**beforeCreate**ï¼šæ­¤æ—¶ç»„ä»¶å®ä¾‹æœªåˆ›å»ºï¼Œå„ä¸ªå±æ€§å‡æ²¡æœ‰ç”Ÿæˆã€‚\n\n**ç¬¬äºŒæ­¥ï¼š**Initã€injectionsã€ reactivityã€‚å±æ€§å‡å·²æ³¨å…¥ç»‘å®šï¼Œè€Œä¸”è¢«`$watch`å˜æˆ`reactivity`ã€‚ä½†æ˜¯`$el`è¿˜æ˜¯æ²¡æœ‰ç”Ÿæˆï¼Œä¹Ÿå°±æ˜¯`DOM`æ²¡æœ‰ç”Ÿæˆï¼›\n\n**createdï¼š**\\$dataå’Œmessageå‡å·²å­˜åœ¨ï¼Œ\\$elè¿˜æ²¡æœ‰ã€‚\n\n**ç¬¬ä¸‰æ­¥ï¼š**åˆ¤æ–­vueå®ä¾‹ä¸­æ˜¯å¦æœ‰\\$elã€‚å¦‚æœæœ‰ï¼Œåˆ™åˆ¤æ–­æ˜¯å¦æœ‰templateã€‚å¦‚æœæ²¡æœ‰åˆ™åœ¨æ‰‹åŠ¨æŒ‚è½½\\$elä¹‹åï¼Œå†åˆ¤æ–­æ˜¯å¦æœ‰templateã€‚\n\n**ç¬¬å››æ­¥ï¼š**\n\n1ã€åœ¨å®ä¾‹å†…éƒ¨æœ‰templateå±æ€§çš„æ—¶å€™ï¼Œç›´æ¥ç”¨å†…éƒ¨çš„ï¼Œç„¶åè°ƒç”¨renderå‡½æ•°å»æ¸²æŸ“ã€‚ \n\n2ã€åœ¨å®ä¾‹å†…éƒ¨æ²¡æœ‰æ‰¾åˆ°templateï¼Œå°±è°ƒç”¨å¤–éƒ¨çš„htmlã€‚å®ä¾‹å†…éƒ¨çš„templateå±æ€§æ¯”å¤–éƒ¨çš„ä¼˜å…ˆçº§é«˜ã€‚\n\n3ã€è¦æ˜¯å‰ä¸¤è€…éƒ½ä¸æ»¡è¶³ï¼Œé‚£ä¹ˆå°±æŠ›å‡ºé”™è¯¯ã€‚\n\n**beforeMountï¼š**åªç¼–è¯‘äº†æ¨¡æ¿ï¼Œå¹¶æ²¡æœ‰æŒ‚è½½å±æ€§ã€‚å³æ­¤æ—¶å­˜åœ¨çš„è¿˜æ˜¯è™šæ‹ŸDOM\n\n**ç¬¬äº”æ­¥ï¼š**åˆ›å»ºvm.$elæ›¿æ¢è™šæ‹ŸDOMï¼ˆvmä¸ºåˆå§‹åŒ–çš„å®ä¾‹å¯¹è±¡ï¼‰ã€‚\n\n**mountedï¼š**æ­¤æ—¶å±æ€§å·²æŒ‚è½½ã€‚\\$dataã€\\$elå’Œmessageå‡å¤„äºå·²å®šä¹‰çš„çŠ¶æ€ã€‚\n\n\n\n### beforeUpdateå’Œupdatedï¼š\n\nå½“æ•°æ®æ”¹å˜æ—¶ï¼Œè¿™ä¸¤ä¸ªç”Ÿå‘½å‘¨æœŸå‡½æ•°æ§åˆ¶viewå±‚é‡æ–°æ¸²æŸ“ã€‚\n\n**æ¸²æŸ“æ­¥éª¤ï¼š**æ•°æ®æ”¹å˜â€”â€”å¯¼è‡´è™šæ‹ŸDOMçš„æ”¹å˜â€”â€”è°ƒç”¨è¿™ä¸¤ä¸ªç”Ÿå‘½é’©å­å»æ”¹å˜è§†å›¾\n\n**1ã€**åªæœ‰å½“æ•°æ®ä¸æ¨¡æ¿ä¸­çš„æ•°æ®ç»‘å®šæ‰ä¼šè¿™ä¸¤ä¸ªå‡½æ•°æ‰ä¼šæœ‰æ•ˆï¼›\n\n```javascript\nvar vm = new Vue({\n  el: '#app',\n  template: '<div id=\"app\"></div>',  // è¿™é‡Œéœ€è¦æ˜¯<div id=\"app\">{{a}}</div>æ‰æœ‰æ•ˆæœ\n  beforeUpdate: function() {\n    console.log('è°ƒç”¨äº†beforeUpdate')\n  },\n  updated: function() {\n    console.log('è°ƒç”¨äº†uodated')\n  },\n  data: {\n    a: 1\n  }\n})\n\nvm.a = 2 // è™½ç„¶æ•°æ®å‘ç”Ÿäº†æ”¹å˜ï¼Œä½†æ˜¯å¹¶æœªä¸æ¨¡æ¿ç»‘å®šï¼Œæ‰€ä»¥æ§åˆ¶å°ä¸ä¼šæ‰“å°ä»»ä½•ä¸€æ¡è¯­å¥\n```\n\n**2ã€**æ•°æ®æ”¹å˜åï¼Œåœ¨beforeUpdateå’Œupdatedä¸­åˆ†åˆ«`console.log(this.$el)`å‘ç°è¾“å‡ºç»“æœç›¸åŒ\n\n**beforeUpdateï¼š**æ•°æ®æ›´æ–°æ—¶è°ƒç”¨ï¼Œå‘ç”Ÿåœ¨è™šæ‹Ÿ DOM é‡æ–°æ¸²æŸ“å’Œæ‰“è¡¥ä¸ä¹‹å‰ã€‚\n**updatedï¼š**ç”±äºæ•°æ®æ›´æ”¹å¯¼è‡´çš„è™šæ‹Ÿ DOM é‡æ–°æ¸²æŸ“å’Œæ‰“è¡¥ä¸ï¼Œåœ¨è¿™ä¹‹åä¼šè°ƒç”¨è¯¥é’©å­ã€‚\n\nthis.$elæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œæˆ–è€…è¯´æ˜¯ä¸€ä¸ªæŒ‡é’ˆã€‚æ‰€ä»¥æ›´æ–°ä¹‹åæ˜¾ç¤ºçš„éƒ½æ˜¯ä¸€æ ·çš„ã€‚å¯ä»¥é€šè¿‡\n\n```javascript\nconsole.log(\"çœŸå®çš„DOMç»“æ„: \"+ document.getElementById('app').innerHTML)\n```\n\nè§‚å¯ŸçœŸå®çš„DOMç»“æ„æ¯”å¯¹ã€‚å®é™…ä¸­å¯ä»¥å‘ç°beforeUpdateä¸­è¿˜æ˜¯åŸæ¥çš„æ•°æ®ï¼Œupdatedå˜æˆäº†ä¹‹åçš„æ•°æ®ã€‚\n\n\n\n### beforeDestoryå’Œdestoryedï¼š\n\n1ã€ä½¿ç”¨`app.$destroy()`è¿›è¡Œé”€æ¯ï¼›\n\né”€æ¯åDOMå…ƒç´ ä»ç„¶å­˜åœ¨ï¼Œä½†æ˜¯å†æ¬¡æ”¹å˜dataçš„å€¼ï¼ŒbeforeUpdateå’Œupdatedå‡ä¸èµ·ä½œç”¨ã€‚å³`Vue` å®ä¾‹æŒ‡ç¤ºçš„æ‰€æœ‰ä¸œè¥¿éƒ½ä¼šè§£ç»‘å®šï¼Œæ‰€æœ‰çš„äº‹ä»¶ç›‘å¬å™¨ä¼šè¢«ç§»é™¤ï¼Œæ‰€æœ‰çš„å­å®ä¾‹ä¹Ÿä¼šè¢«é”€æ¯\n\n\n\n## ç”Ÿå‘½å‘¨æœŸå‡½æ•°çš„ä½¿ç”¨åœºæ™¯ï¼š\n\n1. beforeCreate : ä¸¾ä¸ªæ —å­ï¼šå¯ä»¥åœ¨è¿™åŠ ä¸ªloadingäº‹ä»¶ \n2. created ï¼šåœ¨è¿™ç»“æŸloadingï¼Œè¿˜åšä¸€äº›åˆå§‹åŒ–ï¼Œå®ç°å‡½æ•°è‡ªæ‰§è¡Œ \n3. mounted ï¼š åœ¨è¿™å‘èµ·åç«¯è¯·æ±‚ï¼Œæ‹¿å›æ•°æ®ï¼Œé…åˆè·¯ç”±é’©å­åšä¸€äº›äº‹æƒ…\n4. beforeDestroyï¼š ä½ ç¡®è®¤åˆ é™¤XXå—ï¼Ÿ destroyed ï¼šå½“å‰ç»„ä»¶å·²è¢«åˆ é™¤ï¼Œæ¸…ç©ºç›¸å…³å†…å®¹\n\n\n\n\n\n## ç¤ºä¾‹ä»£ç ï¼šï¼ˆç›‘æµ‹\\$elã€\\$dataã€\\$messageå˜åŒ–ï¼‰\n\n```html\n<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n  <meta charset=\"UTF-8\">\n  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n  <meta http-equiv=\"X-UA-Compatible\" content=\"ie=edge\">\n  <title>vueç”Ÿå‘½å‘¨æœŸå­¦ä¹ </title>\n  <script src=\"https://cdn.jsdelivr.net/npm/vue@2.5.17/dist/vue.js\"></script>\n</head>\n<body>\n  <div id=\"app\">\n    <h1>{{message}}</h1>\n  </div>\n</body>\n<script>\n  var vm = new Vue({\n    el: '#app',\n    data: {\n      message: 'Vueçš„ç”Ÿå‘½å‘¨æœŸ'\n    },\n    // æ¨¡æ¿å°†ä¼š æ›¿æ¢ æŒ‚è½½çš„å…ƒç´ \n    beforeCreate: function() {\n      console.group('------beforeCreateåˆ›å»ºå‰çŠ¶æ€------');\n      console.log(\"%c%s\", \"color:red\" , \"el     : \" + this.$el); //undefined\n      console.log(\"%c%s\", \"color:red\",\"data   : \" + this.$data); //undefined \n      console.log(\"%c%s\", \"color:red\",\"message: \" + this.message) \n    },\n    created: function() {\n      console.group('------createdåˆ›å»ºå®Œæ¯•çŠ¶æ€------');\n      console.log(\"%c%s\", \"color:red\",\"el     : \" + this.$el); //undefined\n      console.log(\"%c%s\", \"color:red\",\"data   : \" + this.$data); //å·²è¢«åˆå§‹åŒ– \n      console.log(\"%c%s\", \"color:red\",\"message: \" + this.message); //å·²è¢«åˆå§‹åŒ–\n    },\n    beforeMount: function() {\n      console.group('------beforeMountæŒ‚è½½å‰çŠ¶æ€------');\n      console.log(\"%c%s\", \"color:red\",\"el     : \" + (this.$el)); //å·²è¢«åˆå§‹åŒ–\n      console.log(this.$el);\n      console.log(\"%c%s\", \"color:red\",\"data   : \" + this.$data); //å·²è¢«åˆå§‹åŒ–  \n      console.log(\"%c%s\", \"color:red\",\"message: \" + this.message); //å·²è¢«åˆå§‹åŒ–  \n    },\n    mounted: function() {\n      console.group('------mounted æŒ‚è½½ç»“æŸçŠ¶æ€------');\n      console.log(\"%c%s\", \"color:red\",\"el     : \" + this.$el); //å·²è¢«åˆå§‹åŒ–\n      console.log(this.$el);\n      console.log(\"%c%s\", \"color:red\",\"data   : \" + this.$data); //å·²è¢«åˆå§‹åŒ–\n      console.log(\"%c%s\", \"color:red\",\"message: \" + this.message); //å·²è¢«åˆå§‹åŒ– \n    },\n    beforeUpdate: function () {\n      console.group('beforeUpdate æ›´æ–°å‰çŠ¶æ€===============ã€‹');\n      console.log(\"çœŸå®çš„DOMç»“æ„: \"+ document.getElementById('app').innerHTML)\n      console.log(\"%c%s\", \"color:red\",\"el     : \" + this.$el);\n      console.log(this.$el);   \n      console.log(\"%c%s\", \"color:red\",\"data   : \" + this.$data); \n      console.log(\"%c%s\", \"color:red\",\"message: \" + this.message); \n    },\n    updated: function () {\n      console.group('updated æ›´æ–°å®ŒæˆçŠ¶æ€===============ã€‹');\n      console.log(\"çœŸå®çš„DOMç»“æ„: \"+ document.getElementById('app').innerHTML)\n      console.log(\"%c%s\", \"color:red\",\"el     : \" + this.$el);\n      console.log(this.$el); \n      console.log(\"%c%s\", \"color:red\",\"data   : \" + this.$data); \n      console.log(\"%c%s\", \"color:red\",\"message: \" + this.message); \n    },\n    beforeDestroy: function () {\n      console.group('beforeDestroy é”€æ¯å‰çŠ¶æ€===============ã€‹');\n      console.log(\"%c%s\", \"color:red\",\"el     : \" + this.$el);\n      console.log(this.$el);    \n      console.log(\"%c%s\", \"color:red\",\"data   : \" + this.$data); \n      console.log(\"%c%s\", \"color:red\",\"message: \" + this.message); \n    },\n    destroyed: function () {\n      console.group('destroyed é”€æ¯å®ŒæˆçŠ¶æ€===============ã€‹');\n      console.log(\"%c%s\", \"color:red\",\"el     : \" + this.$el);\n      console.log(this.$el);  \n      console.log(\"%c%s\", \"color:red\",\"data   : \" + this.$data); \n      console.log(\"%c%s\", \"color:red\",\"message: \" + this.message)\n    }\n  })\n</script>\n</html>\n```\n\n\n\n\n\n\n\n## å‚è€ƒæ–‡çŒ®\n\n1. [è¯¦è§£vueç”Ÿå‘½å‘¨æœŸ - SegmentFaultæ€å¦](https://segmentfault.com/a/1190000011381906)\n2. [API - Vue.js](https://cn.vuejs.org/v2/api/#template)\n3. [vueç”Ÿå‘½å‘¨æœŸè¯¦è§£ - æ˜é‡‘](https://juejin.im/post/5afd7eb16fb9a07ac5605bb3)\n4. [vue2 ä¸ºä»€ä¹ˆbeforeUpdateæ—¶çš„$el å’Œ$dataä¸updatedæ—¶çš„ä¸€æ ·](https://segmentfault.com/q/1010000011521681)\n\n\n\n\n\n","tags":["Vue"],"categories":["Vue","åŸºç¡€åŸç†ç±»"]},{"title":"é™æ€èµ„æºåŠ é€Ÿ","url":"/2018/05/17/é™æ€èµ„æºåŠ é€Ÿ/","content":"<br />\n## ç½‘ç«™çš„é™æ€èµ„æºä»‹ç»\n\nåœ¨ä½¿ç”¨æµè§ˆå™¨æ§åˆ¶å°è§‚æµ‹å„ä¸ªç½‘ç«™çš„è¯¦ç»†ä¿¡æ¯æ—¶ï¼Œå¯ä»¥çœ‹åˆ°`head`æ ‡ç­¾ä¸­å­˜åœ¨å¤§é‡å¼•ç”¨çš„jsã€cssæˆ–å…¶å®ƒç±»å‹çš„æ–‡ä»¶ã€‚å¦‚ä¸‹æ‰€ç¤ºï¼š\n``` html\n<!--æŒ‡å‘ç«™ç‚¹å†…éƒ¨çš„æ–‡ä»¶-->\n<meta content=\"/images/branding/googleg/1x/googleg_standard_color_128dp.png\" itemprop=\"image\">\n<!--ç»å¯¹è·¯å¾„æŒ‡å‘å¤–éƒ¨ç«™ç‚¹çš„js-->\n<script src=\"http://apps.bdimg.com/libs/bootstrap/3.3.0/js/bootstrap.min.js\"></script>\n```\nå¦‚æœç½‘ç«™è§„æ¨¡è¾ƒå°ã€èµ„æºè¯·æ±‚æ•°å°‘ã€å¯¹å­˜å‚¨ç©ºé—´ã€å¹¶å‘é‡çš„è¦æ±‚ä¸é«˜ï¼Œå¯ä»¥å°è¯•å°†èµ„æºä»£ç ä¸ä¸šåŠ¡ä»£ç å­˜æ”¾åœ¨ä¸€èµ·çš„æ–¹å¼ã€‚å¦‚æœç½‘ç«™è§„æ¨¡æ‰©å¤§ï¼Œä¼˜åŒ–çš„æ–¹å¼ä¹Ÿæœ‰è®¸å¤šï¼Œå•ä»é™æ€èµ„æºçš„è§’åº¦çœ‹å¯ä»¥å°†èµ„æºæœåŠ¡å™¨ä¸ä¸šåŠ¡æœåŠ¡å™¨åˆ†ç¦»ã€‚è¿™å°±å¼•å…¥äº†CDNçš„æ¦‚å¿µ\n<br />\n## CDNï¼ˆContent Delivery Networkï¼‰\nCDNå³å†…å®¹åˆ†å‘ç½‘ç»œã€‚é€šä¿—æ„ä¹‰ä¸Šè¯´å°±æ˜¯èƒ½å¤Ÿè®©ä½ è®¿é—®ç½‘ç«™çš„é€Ÿåº¦å˜å¿«ã€‚å¯ä»¥å°†èµ„æºç±»å‹çš„æ–‡ä»¶å­˜å‚¨åœ¨CDNæœåŠ¡å™¨ä¸­ï¼ŒCDNç³»ç»Ÿæ ¹æ®å½“å‰äº’è”ç½‘è¿è¡Œçš„å„é¡¹æŒ‡æ ‡å¦‚èŠ‚ç‚¹çš„è¿æ¥ã€è´Ÿè½½ã€åˆ°ç”¨æˆ·çš„å“åº”æ—¶é—´å’Œè·ç¦»ï¼Œå°†è¯·æ±‚å¯¼å‘ç¦»ç”¨æˆ·æœ€è¿‘çš„æœåŠ¡èŠ‚ç‚¹ä¸Šã€‚è¿™æ ·æ—¢ä¿è¯äº†è®¿é—®çš„ç¨³å®šæ€§ä¸é€Ÿåº¦ä¹Ÿé™ä½äº†ä¸šåŠ¡æœåŠ¡å™¨çš„èµ„æºæµé‡ã€‚\nå›½å†…åšCDNçš„å‚å•†æœ‰é˜¿é‡Œäº‘ã€ç™¾åº¦ã€ä¸ƒç‰›ã€åˆæ‹ç­‰ã€‚é˜¿é‡Œäº‘çš„å”®åä¿éšœæ˜¯æ¯”è¾ƒé è°±çš„ï¼Œå½“ç„¶ä»·æ ¼ä¹Ÿç›¸å¯¹è¾ƒé«˜ï¼Œå…¶ä»–å…¬å¸çš„äº§å“æ²¡ç”¨è¿‡ï¼Œä¸åšè¯„ä»·ã€‚å…¶ä¸­æœ‰ä¸€å®¶å«ç™½å±±äº‘çš„å…¬å¸ï¼Œäº§å“å¥½ä¸å¥½ä¸çŸ¥é“ï¼Œä½†é¢è¯•ä½“éªŒæ˜¯æå¥½çš„ã€‚ï¼ˆå¯æƒœæ²¡æœ‰è°ç»™æˆ‘å¹¿å‘Šè´¹ï¼‰\n<br />\n## å›¾ç‰‡èµ„æºçš„å¤„ç†\né™æ€ç«™ç‚¹ä¸­å¦‚æœå­˜åœ¨çš„å¤§é‡å›¾ç‰‡ï¼Œé‚£ä¹ˆå›¾ç‰‡è¯·æ±‚æ—¶é—´è¿‡é•¿ä¼šå¯¼è‡´ç«™ç‚¹çš„è®¿é—®é€Ÿåº¦å˜æ…¢ã€‚æé«˜ç½‘ç«™çš„å›¾ç‰‡åŠ è½½é€Ÿåº¦å½“ç„¶ä¹Ÿå¯ä»¥ä½¿ç”¨CDNï¼ŒåŒæ—¶ä¹Ÿå¯ä»¥å¯¹å›¾ç‰‡æœ¬èº«è¿›è¡Œå‹ç¼©åˆå¹¶ã€‚è¿™é‡Œæä¾›ä¸€ç§æ€è·¯ï¼š\næœ¬ç«™çš„åŸå§‹èƒŒæ™¯å›¾ç‰‡æ˜¯å¤§å°ä¸º4Må·¦å³æ ¼å¼ä¸ºpngçš„å›¾ç‰‡ã€‚ç»å‹ç¼©åå¤§å°ä¸º1Må·¦å³ï¼Œæ ¼å¼ä»ä¸ºpngï¼Œè‚‰çœ¼çœ‹ä¸å‡ºå˜åŒ–ï¼Œå‹ç¼©ç‡è¾¾åˆ°75%å·¦å³ã€‚å‹ç¼©ç«™ç‚¹[TinyPNG](https://tinypng.com/)ã€‚ä½†æ˜¯å®æµ‹ä¸­è®¿é—®é€Ÿåº¦ä¸æ˜¯å¾ˆæ˜æ˜¾ã€‚\næ‰€ä»¥å†æ¬¡å°†å›¾ç‰‡å‹ç¼©ä¸ºwebPæ ¼å¼ï¼Œè‚‰çœ¼ä»çœ‹ä¸å‡ºå˜åŒ–ï¼Œå‹ç¼©åº¦è¾¾åˆ°90%å·¦å³ã€‚å‹ç¼©ç«™ç‚¹[Squoosh](https://squoosh.app/)ã€‚ä½†æ˜¯è¯¥å›¾ç‰‡æ ¼å¼ç”±è°·æ­Œæ¨å‡ºï¼ŒChromeä¸Operaèƒ½å¤Ÿå®ç°æ”¯æŒï¼ŒFireFoxæš‚ä¸å¯ä»¥ï¼ˆæ®è¯´å¯èƒ½éœ€è¦åˆ°æ˜å¹´ä¸ŠåŠå¹´ï¼‰ã€‚æ‰€ä»¥ä½¿ç”¨Firefoxç­‰æµè§ˆå™¨è®¿é—®å¾—åˆ°çš„æ˜¯`#e7e7e7`ä¸ºèƒŒæ™¯è‰²çš„ç½‘ç«™ã€‚\n<br />\n\n## å‚è€ƒæ–‡çŒ®\n\n1. [CDNæ˜¯ä»€ä¹ˆï¼Ÿä½¿ç”¨CDNæœ‰ä»€ä¹ˆä¼˜åŠ¿ï¼Ÿ - çŸ¥ä¹](https://www.zhihu.com/question/36514327)\n2. [WebP ç›¸å¯¹äº PNGã€JPG æœ‰ä»€ä¹ˆä¼˜åŠ¿ï¼Ÿ- çŸ¥ä¹](https://www.zhihu.com/question/27201061)\n3. [ç½‘ç«™åŠ è½½å›¾ç‰‡é€Ÿåº¦æ…¢å¦‚ä½•ä¼˜åŒ– - SegmentFault æ€å¦](https://segmentfault.com/q/1010000006201412)\n4. [webP - ç»´åŸºç™¾ç§‘](https://zh.wikipedia.org/wiki/WebP)\n<br />\n","tags":["CDN"],"categories":["å»ºç«™å®å½•","é™æ€èµ„æºåŠ é€Ÿ"]},{"title":"äºŒå‰æ ‘çš„ä¸­åºéå†","url":"/2018/04/24/äºŒå‰æ ‘ä¸­åºéå†/","content":"\n<br />\n## æ–¹æ³•ä¸€ï¼šé€’å½’æ–¹å¼\n\n```C++\nclass Solution {\npublic:\n  vector<int> res;\n  vector<int> inorderTraversal(TreeNode* root) {\n    if (root) {\n      inorderTraversal(root->left);\n      res.push_back(root->val);\n      inorderTraversal(root->right);\n    }\n    return res;  \n  }\n};\n```\n\n## æ–¹æ³•äºŒï¼šéé€’å½’ï¼ˆæ ˆ1ï¼‰\nè¯¥æ–¹å¼ä¸å‰åºéå†ä¸­[æ–¹æ³•ä¸‰]()ç›¸ä¼¼ã€‚åªä¸è¿‡åœ¨é€æ­¥éå†å·¦å­èŠ‚ç‚¹çš„è¿‡ç¨‹ä¸­å¹¶ä¸è®°å½•éå†é¡ºåºï¼Œè€Œæ˜¯åœ¨æ ˆä¸­å–å‡ºçš„æ—¶å€™è®°å½•ã€‚å¹¶å°†æ¸¸æ ‡èŠ‚ç‚¹æŒ‡å‘å½“å‰ä»æ ˆä¸­å–å‡ºèŠ‚ç‚¹çš„å³å­èŠ‚ç‚¹ã€‚æŠŠä»–å½“æˆæ ¹èŠ‚ç‚¹ç»§ç»­éå†ã€‚\n```C++\nclass Solution {\npublic:\n  vector<int> res;\n  vector<int> inorderTraversal(TreeNode* root) {\n    vector<int> res;\n    if (!root) {\n      return res;\n    }\n    stack<TreeNode*> s;\n    TreeNode* node = root;\n    while(!s.empty() || node) {\n      if (node) {\n        s.push(node);\n        node = node->left;\n      } else {\n        TreeNode* temp = s.top();\n        s.pop();\n        res.push_back(temp->val);\n        node = temp->right;\n      }\n    }\n    return res;  \n  }\n};\n```\n\n## æ–¹æ³•ä¸‰ï¼šéé€’å½’\næ–¹æ³•ä¸‰åˆ©ç”¨äº†ä¸€ä¸ªæ¸¸æ ‡èŠ‚ç‚¹å’Œä¸€ä¸ªå‰é©±èŠ‚ç‚¹ã€‚æŒ‰ç…§ä¸­åºéå†çš„é¡ºåºï¼Œå‰é©±èŠ‚ç‚¹æ˜¯æ¸¸æ ‡èŠ‚ç‚¹çš„ä¸Šä¸€ä¸ªèŠ‚ç‚¹ã€‚\næ²¿ç€å·¦å­æ ‘éå†ï¼Œå¦‚æœå·¦å­æ ‘ä¸å­˜åœ¨ï¼Œåˆ™å°†å½“å‰æ¸¸æ ‡èŠ‚ç‚¹å¯¼å…¥åˆ—è¡¨ã€‚å¦‚æœå­˜åœ¨åˆ™å°†å½“å‰æ¸¸æ ‡èŠ‚ç‚¹çš„å·¦å­æ ‘ä¸­åºéå†çš„æœ€åä¸€ä¸ªèŠ‚ç‚¹æŒ‡å‘è‡ªèº«ï¼ˆå‡è®¾è¿˜æ²¡æœ‰æŒ‡å‘çš„æƒ…å†µä¸‹ï¼‰ï¼Œè§å›¾ä¸­ç®­å¤´ã€‚å¦‚æœå·²ç»æŒ‡å‘è‡ªèº«ï¼Œé‚£ä¹ˆå°†å½“å‰èŠ‚ç‚¹å¯¼å…¥åˆ—è¡¨ã€‚å¹¶ä¸”æ¸¸æ ‡æŒ‡å‘å½“å‰èŠ‚ç‚¹çš„å³å­èŠ‚ç‚¹ï¼Œç»§ç»­å¾ªç¯ç›´åˆ°æ¸¸æ ‡èŠ‚ç‚¹æŒ‡ä¸ºç©ºã€‚\n\n![æ–¹æ³•ä¸‰å›¾ç¤º](https://cdn.jsdelivr.net/gh/Cloving/Atlas-Github/blog/notePicture/äºŒå‰æ ‘çš„ä¸­åºéå†/äºŒå‰æ ‘ä¸­åºéå†.png)\n\n```C++\nclass Solution {\npublic:\n  vector<int> inorderTraversal(TreeNode* root) {\n    vector<int> res;\n    if (!root) {\n      return res;\n    }\n    TreeNode* pre;\n    TreeNode* cur = root;\n    while(cur) {\n      if (!cur->left) {\n        res.push_back(cur->val);\n        cur = cur->right;\n      } else {\n        pre = cur->left;\n        while(pre->right && pre->right != cur) {\n          pre = pre->right;\n        }\n        if (!pre->right) {\n          pre->right = cur;\n          cur = cur->left;\n        } else {\n          pre->right = NULL;\n          res.push_back(cur->val);\n          cur = cur->right;\n        }\n      }\n    }\n    return res;\n  }\n};\n```\n<br />\n","tags":["æ•°æ®ç»“æ„","C++","äºŒå‰æ ‘"],"categories":["æ•°æ®ç»“æ„ä¸ç®—æ³•","äºŒå‰æ ‘"]},{"title":"äºŒå‰æ ‘çš„å‰åºéå†","url":"/2018/04/15/äºŒå‰æ ‘å‰åºéå†/","content":"\n<br />\n## æ–¹æ³•ä¸€ï¼šé€’å½’æ–¹å¼\n\n```c++\nclass Solution {\npublic:\n  vector<int> res;\n  vector<int> preorderTraversal(TreeNode* root) {\n    if (root) {\n      res.push_back(root->val);\n      preorderTraversal(root->left); \n      preorderTraversal(root->right);\n    }\n    return res;\n  }\n};\n```\n\n## æ–¹æ³•äºŒï¼šéé€’å½’ï¼ˆæ ˆ1ï¼‰\n\né¦–å…ˆå°†æ ¹èŠ‚ç‚¹å…¥æ ˆã€‚ç„¶åå¾ªç¯éå†ï¼Œå–å‡ºæ ¹èŠ‚ç‚¹ï¼Œè€ƒè™‘åˆ°æ ˆçš„**åè¿›å…ˆå‡º**åŸåˆ™ï¼Œé¦–å…ˆå…¥æ ˆå³è¾¹èŠ‚ç‚¹ï¼Œä¹‹åå…¥æ ˆå·¦è¾¹èŠ‚ç‚¹ã€‚å†æ¬¡å–å‡ºæ ˆé¡¶èŠ‚ç‚¹ç›´åˆ°æ ˆä¸ºç©ºã€‚\n\n```c++\nclass Solution {\npublic:\n  vector<int> preorderTraversal(TreeNode* root) {\n    vector<int> res;\n    if (!root) {\n      return res;\n    }\n    stack<TreeNode* > s{{root}};\n    while(!s.empty()) {\n      TreeNode* node = s.top();\n      res.push_back(node->val);\n      s.pop();\n      if (node->right) {\n        s.push(node->right);\n      }\n      if (node->left) {\n        s.push(node->left);\n      }\n    }\n    return res;\n  }\n};\n```\n\n## æ–¹æ³•ä¸‰ï¼šéé€’å½’ï¼ˆæ ˆ2ï¼‰\n\n1ã€æ–°å»ºæ ˆå¹¶ä¸”è®¾ç½®ä¸€ä¸ªæ¸¸æ ‡èŠ‚ç‚¹ï¼Œæ¸¸æ ‡èŠ‚ç‚¹èµ°è¿‡çš„è·¯å¾„å°±æ˜¯äºŒå‰æ ‘çš„å‰åºéå†é¡ºåºã€‚\n\n2ã€é¦–å…ˆå¾ªç¯æ¡ä»¶æ˜¯æ ˆä¸ä¸ºç©ºä¸”æ¸¸æ ‡èŠ‚ç‚¹å­˜åœ¨ã€‚æ¸¸æ ‡èŠ‚ç‚¹é¦–å…ˆä¸ºæ ¹èŠ‚ç‚¹ã€‚\n\n3ã€æ¸¸æ ‡èŠ‚ç‚¹æ²¿ç€è‡ªèº«å·¦å­æ ‘éå†ï¼Œå°†éå†é¡ºåºå­˜åˆ°åˆ—è¡¨å½“ä¸­ï¼Œå¹¶å°†éå†åˆ°çš„èŠ‚ç‚¹é€ä¸ªå…¥æ ˆï¼Œç›´åˆ°å·¦å­èŠ‚ç‚¹ä¸å­˜åœ¨ã€‚\n\n4ã€å–å‡ºæ ˆé¡¶å…ƒç´ çš„å³å­èŠ‚ç‚¹ä½œä¸ºæ¸¸æ ‡èŠ‚ç‚¹ï¼Œå› ä¸ºæ ˆé¡¶å…ƒç´ åœ¨åˆå§‹å…¥æ ˆçš„è¿‡ç¨‹ä¸­å·²ç»è¢«è®°å½•ï¼Œä¸å¿…é‡å¤è®°å½•ã€‚ï¼ˆä¹‹ååšçš„å®é™…ä¸Šæ˜¯å°†æ­¤æ—¶çš„æ¸¸æ ‡èŠ‚ç‚¹å½“åšæ ¹èŠ‚ç‚¹å†æ¬¡æ‰§è¡Œä»¥ä¸Šæ“ä½œï¼‰ã€‚\n\n5ã€ç›´åˆ°æ ˆä¸ºç©ºä¸”æ¸¸æ ‡èŠ‚ç‚¹ä¸å­˜åœ¨ã€‚\n\n```c++\nclass Solution {\npublic:\n  vector<int> preorderTraversal(TreeNode* root) {\n    vector<int> res; \n    if (!root) {\n      return res;\n    }\n    stack<TreeNode*> s;\n    TreeNode* node = root;\n    while (!s.empty() || node) {\n      if (node) {\n        res.push_back(node->val);\n        s.push(node);\n        node = node->left;\n      } else {\n        TreeNode* t = s.top();\n        s.pop();\n        node = t->right;\n      }\n    }\n    return res;\n  }\n};\n```\n<br />\n","tags":["æ•°æ®ç»“æ„","C++","äºŒå‰æ ‘"],"categories":["æ•°æ®ç»“æ„ä¸ç®—æ³•","äºŒå‰æ ‘"]}]